import{A as y}from"./AdminNavBar-Dn0zGxbW.js";import{P as v}from"./PageNation-BsS3_Kue.js";import{m as w}from"./mixin-CE07gU2g.js";import{_ as x,l as a,j as t,i as u,F as p,v as m,B as l,C as n,I as k,y as h,k as _,e as d}from"./index-D-hwiczx.js";const U={components:{AdminNavBar:y,PageNation:v},mixins:[w],data(){return{allProducts:[],url:"https://vue3-course-api.hexschool.io",api_path:"wei123",pagination:{},myModal:"",product:"",title:"",category:"",origin_price:"",price:"",unit:"",description:"",content:"",is_enabled:!1,imageUrl:"",imagesUrl:""}},methods:{checkAdmin(){const i=`${this.url}/api/user/check`;this.$http.post(i).then(()=>{this.getPageProducts()}).catch(e=>{alert(e.response.data.message),this.$router.push("/adminLogin")})},getPageProducts(i=1){this.$http.get(`${this.url}/v2/api/${this.api_path}/admin/products?page=${i}`).then(e=>{this.pagination=e.data.pagination,this.allProducts=e.data.products,window.scrollTo(0,0)}).catch(e=>{alert(e.response.data.message)})},openModal(i){this.myModal.show(),this.loadingCircle(),this.$http.get(`${this.url}/v2/api/${this.api_path}/product/${i}`).then(e=>{this.product=e.data.product,this.title=e.data.product.title,this.category=e.data.product.category,this.origin_price=parseInt(e.data.product.origin_price),this.price=parseInt(e.data.product.price),this.unit=e.data.product.unit,this.description=e.data.product.description,this.content=e.data.product.content,this.is_enabled=e.data.product.is_enabled,this.imageUrl=e.data.product.imageUrl,this.imagesUrl=e.data.product.imagesUrl}).catch(e=>{console.log(e.response.data.message)})},adviseProduct(i){this.$http.put(`${this.url}/v2/api/${this.api_path}/admin/product/${i}`,{data:{title:this.title,category:this.category,origin_price:this.origin_price,price:this.price,unit:this.unit,description:this.description,content:this.content,is_enabled:this.is_enabled,imageUrl:this.imageUrl,imagesUrl:this.imagesUrl}}).then(()=>{alert("修改產品成功"),this.getPageProducts(1),this.myModal.hide()}).catch(e=>{console.log(e.response.data.message)})},deleteProduct(i){this.$http.delete(`${this.url}/v2/api/${this.api_path}/admin/product/${i}`).then(()=>{alert("刪除產品成功")}).catch(e=>{console.log(e.response.data.message)})}},mounted(){const i=document.cookie.replace(/(?:(?:^|.*;\s*)hexToken\s*\=\s*([^;]*).*$)|^.*$/,"$1");this.$http.defaults.headers.common.Authorization=i,this.checkAdmin(),this.myModal=new bootstrap.Modal(this.$refs.detailModal),this.loadingCircle()}},P={class:"container-fluid px-0"},C={class:"container py-48"},M=t("h2",{class:"text-center fs-16 fs-md-24 fs-lg-32"},"後台產品列表",-1),V={class:"table mt-4"},j=t("thead",null,[t("tr",null,[t("th",{width:"80"},"分類"),t("th",null,"產品名稱"),t("th",{width:"120"},"售價"),t("th",{width:"120"},"啟用與否"),t("th",{width:"150"},"修改產品內容"),t("th",{width:"150"},"刪除產品")])],-1),A={key:0,class:""},B={key:1,class:"text-danger"},D=["onClick"],L=["onClick"],N={class:"container"},I={class:"modal fade",id:"modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"detailModal"},S={class:"modal-dialog modal-xl"},T={class:"modal-content"},$=t("div",{class:"modal-header bg-dark"},[t("h1",{class:"modal-title fs-32 text-white",id:"exampleModalLabel"}," 修改產品 "),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),F={class:"modal-body"},z={ref:"form"},E={class:"row justify-content-center"},q={class:"col-10"},G=t("label",{class:"fs-24 mb-8 fw-bold",for:"title"},"產品名稱",-1),H={class:"row justify-content-center"},J={class:"col-5"},K=t("label",{class:"fs-24 mb-8 fw-bold",for:"title"},"產品原價",-1),O={class:"col-5"},Q=t("label",{class:"fs-24 mb-8 fw-bold",for:"title"},"產品特價",-1),R={class:"row mb-32 justify-content-center"},W={class:"col-10"},X=t("label",{class:"fs-24 fw-bold",for:"articleCategory"}," 產品分類 ",-1),Y={class:"col-10"},Z=t("label",{class:"fs-24 fw-bold",for:"description"},"產品簡述",-1),tt=t("label",{class:"fs-24 fw-bold",for:"description"},"產品內容",-1),et={class:"row justify-content-center"},st={class:"col-5"},ot=t("label",{class:"fs-24 fw-bold"},"主圖預覽",-1),it=["src"],lt={class:"col-5 d-flex flex-column"},nt={class:"row d-flex flex-column justify-content-between"},at=t("h3",{class:"fs-24 fw-bold"},"多圖預覽",-1),dt=["onUpdate:modelValue"],ct=["src"],rt=t("h3",{class:"fs-24 fw-bold"},"產品狀態",-1),ht={class:"form-check form-switch"},pt={class:"form-check-label",for:"flexSwitchCheckDefault"},ut={class:"modal-footer"},mt=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," 關閉 ",-1),_t={class:"container d-flex justify-content-end"};function gt(i,e,bt,ft,o,c){const g=_("admin-nav-bar"),b=_("page-nation");return d(),a(p,null,[t("div",P,[u(g)]),t("div",C,[M,t("table",V,[j,t("tbody",null,[(d(!0),a(p,null,m(o.allProducts,s=>(d(),a("tr",{key:s.id},[t("td",null,h(s.category),1),t("td",null,h(s.title),1),t("td",null,h(s.price),1),t("td",null,[s.is_enabled?(d(),a("span",A,"啟用")):(d(),a("span",B,"未啟用"))]),t("td",null,[t("button",{class:"btn btn-success",onClick:r=>c.openModal(s.id)}," 修改產品內容 ",8,D)]),t("td",null,[t("button",{class:"btn btn-danger",onClick:r=>c.deleteProduct(s.id)}," 刪除產品 ",8,L)])]))),128))])])]),t("div",N,[t("div",I,[t("div",S,[t("div",T,[$,t("div",F,[t("form",z,[t("div",E,[t("div",q,[G,l(t("input",{type:"text",class:"rounded mb-32 form-check-input",style:{width:"100%",height:"40px"},"onUpdate:modelValue":e[0]||(e[0]=s=>o.title=s),name:"title",id:"title"},null,512),[[n,o.title]])])]),t("div",H,[t("div",J,[K,l(t("input",{type:"number",class:"rounded mb-32 form-check-input",style:{width:"100%",height:"40px"},"onUpdate:modelValue":e[1]||(e[1]=s=>o.origin_price=s),name:"origin_price",id:"origin_price"},null,512),[[n,o.origin_price]])]),t("div",O,[Q,l(t("input",{type:"number",class:"rounded mb-32 form-check-input",style:{width:"100%",height:"40px"},"onUpdate:modelValue":e[2]||(e[2]=s=>o.price=s),name:"price",id:"price"},null,512),[[n,o.price]])])]),t("div",R,[t("div",W,[X,l(t("input",{type:"text",class:"rounded mb-32 form-check-input",style:{width:"100%",height:"40px"},placeholder:"請填入產品分類",name:"category",id:"category","onUpdate:modelValue":e[3]||(e[3]=s=>o.category=s)},null,512),[[n,o.category]])]),t("div",Y,[Z,l(t("textarea",{"onUpdate:modelValue":e[4]||(e[4]=s=>o.description=s),class:"rounded mb-24 form-check-input",style:{width:"100%",height:"120px"},placeholder:"請填入 100 字內描述",name:"description",id:"description"},null,512),[[n,o.description]]),tt,l(t("textarea",{type:"text","onUpdate:modelValue":e[5]||(e[5]=s=>o.content=s),class:"rounded mb-24 form-check-input",style:{width:"100%",height:"240px"},placeholder:"請輸入產品內容",name:"content",id:"content"},null,512),[[n,o.content]])])]),t("div",et,[t("div",st,[ot,l(t("input",{type:"text",name:"image",id:"image","onUpdate:modelValue":e[6]||(e[6]=s=>o.imageUrl=s),class:"w-100 rounded mb-16 form-check-input"},null,512),[[n,o.imageUrl]]),t("img",{src:o.imageUrl,alt:"",style:{width:"416px",height:"440px","object-fit":"cover"}},null,8,it)]),t("div",lt,[t("div",nt,[at,(d(!0),a(p,null,m(o.imagesUrl,(s,r)=>(d(),a("div",{class:"container",key:s.id},[l(t("input",{type:"text",name:"image",id:"image","onUpdate:modelValue":f=>o.imagesUrl[r]=f,class:"w-100 rounded mb-16 form-check-input"},null,8,dt),[[n,o.imagesUrl[r]]]),t("img",{src:s,alt:"多圖",width:"30%",class:"border border-2 mb-16"},null,8,ct)]))),128))]),rt,t("div",ht,[l(t("input",{class:"form-check-input",type:"checkbox",id:"flexSwitchCheckDefault","onUpdate:modelValue":e[7]||(e[7]=s=>o.is_enabled=s)},null,512),[[k,o.is_enabled]]),t("label",pt,h(o.is_enabled?"產品公開":"產品不公開"),1)])])])],512)]),t("div",ut,[mt,t("button",{type:"button",class:"btn btn-primary",onClick:e[8]||(e[8]=s=>c.adviseProduct(o.product.id))}," 修改產品 ")])])])],512)]),t("div",_t,[u(b,{class:"",pagination:o.pagination,"get-page-products":c.getPageProducts},null,8,["pagination","get-page-products"])])],64)}const kt=x(U,[["render",gt]]);export{kt as default};
