import{N as y,P as w,c as d}from"./NavBar-DOSmy6kA.js";import{f as h}from"./favoriteStore-BCPThjgz.js";import{_ as C,t as f,u as _,l as a,j as t,i as n,F as u,v as x,z as S,e as i,y as p,q as k,s as L,k as l}from"./index-DUY3yl3W.js";const F={props:["finalTotal"],data(){return{api_path:"wei123",url:"https://vue3-course-api.hexschool.io",selectValue:"",cartProducts:[],cartList:{},final_total:"",form:{user:{name:"",email:"",tel:"",address:""},message:"",qty:0},couponModal:"",onSale:!1,favoriteProducts:[]}},computed:{...f(h,["favoriteList"]),...f(d,["cartStore"])},components:{NavBar:y,PageFooter:w},methods:{..._(h,["getFavoriteList","setStorage"]),..._(d,["getCartList"]),backToShop(){this.$router.push("/userProduct")},loadingCircle(){let s=this.$loading.show({container:this.fullPage?null:this.$refs.formContainer,canCancel:!0,onCancel:this.onCancel});setTimeout(()=>{s.hide()},500)},getProduct(s){return this.$http.get(`${this.url}/v2/api/${this.api_path}/product/${s}`).then(e=>{if(this.favoriteProducts.indexOf(e.data.product)===-1)return e.data.product}).catch(e=>{console.log(e.response.data.message)})},async fetchFavoriteProducts(){try{const s=await Promise.all(this.favoriteList.map(e=>this.getProduct(e)));this.favoriteProducts=s.filter(Boolean)}catch(s){console.log(s.response.data.message)}},addToCart(s){this.$http.post(`${this.url}/v2/api/${this.api_path}/cart`,{data:{product_id:s,qty:1}}).then(()=>{alert("加入購物車成功"),this.favoriteProducts.splice(this.favoriteProducts.indexOf(s),1),this.favoriteList.splice(this.favoriteList.indexOf(s),1),this.setStorage(),this.getCartList()}).catch(e=>{console.log(e.response.data.message)})},removeFavorite(s){this.favoriteProducts.splice(this.favoriteProducts.indexOf(s),1),this.favoriteList.splice(this.favoriteList.indexOf(s),1),this.setStorage(),this.getCartList(),window.scroll(0,0)}},mounted(){this.loadingCircle(),this.getFavoriteList(),this.fetchFavoriteProducts(),window.scroll(0,0)}},c=s=>(k("data-v-3ba353a2"),s=s(),L(),s),$={class:"container-fluid px-0"},T={class:"container-fluid px-0",style:{"min-height":"100vh"}},B={class:"container"},N=c(()=>t("h2",{class:"text-center py-60 pb-16 fs-24 fs-lg-32"},"收藏列表",-1)),O={class:"container px-0"},I={key:0,class:"table table-responsive"},V=c(()=>t("thead",null,[t("tr",null,[t("th",{class:"fs-12 fs-md-24",style:{width:"10%"}},"X"),t("th",{class:"fs-12 fs-md-24",style:{width:"30%"}},"品名"),t("th",{class:"fs-12 fs-md-24 rwd"},"圖片"),t("th",{class:"fs-12 fs-md-24",style:{width:"20%"}},"價格"),t("th",{class:"fs-12 fs-md-24",style:{width:"20%"}},"加入購物車")])],-1)),q={class:"align-middle px-0"},j=["onClick"],U=c(()=>t("i",{class:"bi bi-trash3-fill fs-md-24"},null,-1)),z=[U],A={class:"fs-12 fs-sm-16 fs-md-24 align-middle"},D={class:"align-middle"},E=["src"],M={class:"align-middle fs-12 fs-sm-16 fs-md-24"},X={class:"align-middle"},G=["onClick"],H={key:1,class:"text-center fs-24"},J=c(()=>t("br",null,null,-1)),K={class:"container-fluid px-0"},Q={class:"container-fluid"};function R(s,e,W,Y,m,r){const v=l("NavBar"),g=l("PageFooter"),b=l("router-view");return i(),a(u,null,[t("div",$,[n(v)]),t("div",T,[t("div",B,[N,t("div",O,[s.favoriteList.length!==0?(i(),a("table",I,[V,t("tbody",null,[(i(!0),a(u,null,x(m.favoriteProducts,o=>(i(),a("tr",{key:o.id},[t("td",q,[t("button",{class:"btn btn-white",onClick:P=>r.removeFavorite(o.id)},z,8,j)]),t("td",A,p(o.title),1),t("td",D,[t("img",{alt:"產品圖片",class:"rwd",src:o.imageUrl,style:{"object-fit":"cover"}},null,8,E)]),t("td",M,p(o.price),1),t("td",X,[t("button",{class:"btn btn-footer",onClick:P=>r.addToCart(o.id)}," 加入購物車 ",8,G)])]))),128))])])):(i(),a("h2",H,[S(" 您的收藏列表沒有東西喔，請先加入商品！"),J,t("button",{class:"btn btn-gray mt-32",onClick:e[0]||(e[0]=(...o)=>r.backToShop&&r.backToShop(...o))}," 返回商品頁面 ")]))])])]),t("div",K,[n(g)]),t("div",Q,[n(b)])],64)}const et=C(F,[["render",R],["__scopeId","data-v-3ba353a2"]]);export{et as default};
//# sourceMappingURL=UserFavorite-CiyGb3Q6.js.map
