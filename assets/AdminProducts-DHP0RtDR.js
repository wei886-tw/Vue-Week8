import{A as v}from"./AdminNavBar-BnQqd8CE.js";import{P as U}from"./PageNation-Cqm7jR3P.js";import{m as w}from"./mixin-CyhdtnIY.js";import{_ as x,l,j as t,i as m,F as u,v as _,G as a,H as r,I as k,y as p,k as g,e as n}from"./index-U4DtIXau.js";const P={components:{AdminNavBar:v,PageNation:U},mixins:[w],data(){return{allProducts:[],url:"https://vue3-course-api.hexschool.io",api_path:"wei123",pagination:{},myModal:"",product:"",title:"",category:"",origin_price:"",price:"",unit:"",description:"",content:"",is_enabled:!1,imageUrl:"",imagesUrl:[]}},methods:{getPageProducts(c=1){this.$http.get(`${this.url}/v2/api/${this.api_path}/admin/products?page=${c}`).then(e=>{this.pagination=e.data.pagination,this.allProducts=e.data.products,window.scrollTo(0,0)}).catch(e=>{alert(e.response.data.message)})},openModal(c,e){c==="old"?this.$http.get(`${this.url}/v2/api/${this.api_path}/product/${e}`).then(o=>{this.product=o.data.product,this.title=o.data.product.title,this.category=o.data.product.category,this.origin_price=parseInt(o.data.product.origin_price),this.price=parseInt(o.data.product.price),this.unit=o.data.product.unit,this.description=o.data.product.description,this.content=o.data.product.content,this.is_enabled=o.data.product.is_enabled,this.imageUrl=o.data.product.imageUrl,this.imagesUrl=o.data.product.imagesUrl,this.loadingCircle(),this.myModal.show()}).catch(o=>{console.log(o.response.data.message)}):this.myModal.show()},updateProduct(c,e){c==="old"?(this.openModal("old",e),this.$http.put(`${this.url}/v2/api/${this.api_path}/admin/product/${e}`,{data:{title:this.title,category:this.category,origin_price:this.origin_price,price:this.price,unit:this.unit,description:this.description,content:this.content,is_enabled:this.is_enabled,imageUrl:this.imageUrl,imagesUrl:this.imagesUrl}}).then(()=>{alert("產品修改成功"),this.title="",this.category="",this.origin_price="",this.price="",this.unit="",this.description="",this.content="",this.is_enabled="",this.imageUrl="",this.imagesUrl="",this.myModal.hide(),this.getPageProducts(1)}).catch(o=>{console.log(o.response.data.message)})):this.$http.post(`${this.url}/v2/api/${this.api_path}/admin/product/`,{data:{title:this.title,category:this.category,origin_price:this.origin_price,price:this.price,unit:this.unit,description:this.description,content:this.content,is_enabled:this.is_enabled,imageUrl:this.imageUrl,imagesUrl:this.imagesUrl}}).then(()=>{alert("建立產品成功"),this.getPageProducts(1),this.myModal.hide()}).catch(o=>{console.log(o.response.data.message)})},deleteProduct(c){this.$http.delete(`${this.url}/v2/api/${this.api_path}/admin/product/${c}`).then(()=>{alert("刪除產品成功")}).catch(e=>{console.log(e.response.data.message)})},imagesUrlPush(){this.imagesUrl=[],this.imagesUrl.push()},imagesUrlPop(){this.imagesUrl.pop()}},mounted(){this.myModal=new bootstrap.Modal(this.$refs.detailModal),this.getPageProducts(),this.loadingCircle()}},M={class:"container-fluid px-0"},C={class:"container py-48"},V={class:"container d-flex justify-content-between mb-24"},j=t("h2",{class:"text-center fs-16 fs-md-24 fs-lg-32"},"後台產品列表",-1),A={class:"table mt-4"},B=t("thead",null,[t("tr",null,[t("th",{width:"80"},"分類"),t("th",null,"產品名稱"),t("th",{width:"120"},"售價"),t("th",{width:"120"},"啟用與否"),t("th",{width:"150"},"修改產品內容"),t("th",{width:"150"},"刪除產品")])],-1),D={key:0,class:""},L={key:1,class:"text-danger"},N=["onClick"],I=["onClick"],S={class:"container"},F={class:"modal fade",id:"modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"detailModal"},T={class:"modal-dialog modal-xl"},E={class:"modal-content"},G={class:"modal-header bg-dark"},H={key:0,class:"modal-title fs-32 text-white",id:"exampleModalLabel"},q={key:1,class:"modal-title fs-32 text-white",id:"exampleModalLabel"},z=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),J={class:"modal-body"},K={ref:"form"},O={class:"row justify-content-center"},Q={class:"col-4"},R=t("label",{class:"fs-24 mb-8 fw-bold",for:"title"},"產品主圖網址",-1),W=["src"],X=t("label",{class:"fs-24 mb-8 fw-bold",for:"title"},"產品多圖設置",-1),Y={key:0},Z={class:"form-group"},$=["for"],tt=["id","onUpdate:modelValue"],et=["src"],st={key:0},it={key:1},ot={key:1},lt={class:"col-8"},nt=t("label",{class:"fs-24 mb-8 fw-bold",for:"title"},"產品名稱",-1),dt={class:"row justify-content-end"},at={class:"col-6"},rt=t("label",{class:"fs-24 mb-8 fw-bold",for:"title"},"產品原價",-1),ct={class:"col-6"},ht=t("label",{class:"fs-24 mb-8 fw-bold",for:"title"},"產品特價",-1),pt={class:"row justify-content-end"},ut={class:"col-6"},mt=t("label",{class:"fs-24 mb-8 fw-bold",for:"title"},"產品單位",-1),_t={class:"col-6"},gt=t("label",{class:"fs-24 mb-8 fw-bold",for:"title"},"產品分類",-1),bt={class:"row justify-content-end"},ft={class:"col-12"},yt=t("label",{class:"fs-24 mb-8 fw-bold",for:"title"},"產品描述",-1),vt={class:"col-12"},Ut=t("label",{class:"fs-24 mb-8 fw-bold",for:"title"},"產品內容",-1),wt={class:"col-12"},xt=t("h3",{class:"fs-24 fw-bold"},"產品狀態",-1),kt={class:"form-check form-switch"},Pt={class:"form-check-label",for:"flexSwitchCheckDefault"},Mt={class:"modal-footer"},Ct=t("button",{type:"button",class:"btn btn-secondary border","data-bs-dismiss":"modal"}," 關閉 ",-1),Vt={class:"container d-flex justify-content-end"};function jt(c,e,o,At,i,d){const b=g("admin-nav-bar"),f=g("page-nation");return n(),l(u,null,[t("div",M,[m(b)]),t("div",C,[t("div",V,[j,t("button",{class:"btn btn-dark",onClick:e[0]||(e[0]=s=>d.openModal("new"))},"建立新產品")]),t("table",A,[B,t("tbody",null,[(n(!0),l(u,null,_(i.allProducts,s=>(n(),l("tr",{key:s.id},[t("td",null,p(s.category),1),t("td",null,p(s.title),1),t("td",null,p(s.price),1),t("td",null,[s.is_enabled?(n(),l("span",D,"啟用")):(n(),l("span",L,"未啟用"))]),t("td",null,[t("button",{class:"btn btn-success",onClick:h=>d.openModal("old",s.id)}," 修改產品內容 ",8,N)]),t("td",null,[t("button",{class:"btn btn-danger",onClick:h=>d.deleteProduct(s.id)}," 刪除產品 ",8,I)])]))),128))])])]),t("div",S,[t("div",F,[t("div",T,[t("div",E,[t("div",G,[i.imagesUrl.length!==0?(n(),l("h1",H," 修改產品 ")):(n(),l("h1",q," 新增產品 ")),z]),t("div",J,[t("form",K,[t("div",O,[t("div",Q,[R,a(t("input",{type:"text",class:"rounded mb-32 form-control",style:{width:"100%",height:"40px"},"onUpdate:modelValue":e[1]||(e[1]=s=>i.imageUrl=s),name:"imageUrl",id:"imageUrl",placeholder:"請輸入網址"},null,512),[[r,i.imageUrl]]),t("img",{src:i.imageUrl,alt:"",width:"100%",style:{"object-fit":"cover"}},null,8,W),X,Array.isArray(i.imagesUrl)?(n(),l("div",Y,[(n(!0),l(u,null,_(i.imagesUrl,(s,h)=>(n(),l("div",{class:"mb-8",key:h},[t("div",Z,[t("label",{for:`imagesUrl${h}`,class:"form-label"},"圖片網址",8,$),a(t("input",{id:`imagesUrl${h}`,"onUpdate:modelValue":y=>i.imagesUrl[h]=y,type:"text",class:"form-control",placeholder:"請輸入圖片連結"},null,8,tt),[[r,i.imagesUrl[h]]])]),t("img",{class:"img-fluid",src:s},null,8,et)]))),128)),!i.imagesUrl.length||i.imagesUrl[i.imagesUrl.length-1]?(n(),l("div",st,[t("button",{class:"btn btn-primary btn-sm d-block w-100",onClick:e[2]||(e[2]=s=>i.imagesUrl.push(""))}," 新增圖片 ")])):(n(),l("div",it,[t("button",{class:"btn btn-danger btn-sm d-block w-100",onClick:e[3]||(e[3]=(...s)=>d.imagesUrlPop&&d.imagesUrlPop(...s))}," 刪除圖片 ")]))])):(n(),l("div",ot,[t("button",{class:"btn btn-primary btn-sm d-block w-100",onClick:e[4]||(e[4]=(...s)=>d.imagesUrlPush&&d.imagesUrlPush(...s))}," 新增圖片 ")]))]),t("div",lt,[nt,a(t("input",{type:"text",class:"rounded mb-32 form-check-input",style:{width:"100%",height:"40px"},"onUpdate:modelValue":e[5]||(e[5]=s=>i.title=s),name:"title",id:"title"},null,512),[[r,i.title]]),t("div",dt,[t("div",at,[rt,a(t("input",{type:"number",class:"rounded mb-32 form-check-input",style:{width:"100%",height:"40px"},"onUpdate:modelValue":e[6]||(e[6]=s=>i.origin_price=s),name:"origin_price",id:"origin_price"},null,512),[[r,i.origin_price]])]),t("div",ct,[ht,a(t("input",{type:"number",class:"rounded mb-32 form-check-input",style:{width:"100%",height:"40px"},"onUpdate:modelValue":e[7]||(e[7]=s=>i.price=s),name:"price",id:"price"},null,512),[[r,i.price]])])]),t("div",pt,[t("div",ut,[mt,a(t("input",{type:"text",class:"rounded mb-32 form-check-input",style:{width:"100%",height:"40px"},"onUpdate:modelValue":e[8]||(e[8]=s=>i.unit=s),name:"unit",id:"unit"},null,512),[[r,i.unit]])]),t("div",_t,[gt,a(t("input",{type:"text",class:"rounded mb-32 form-check-input",style:{width:"100%",height:"40px"},"onUpdate:modelValue":e[9]||(e[9]=s=>i.category=s),name:"category",id:"category"},null,512),[[r,i.category]])])]),t("div",bt,[t("div",ft,[yt,a(t("textarea",{type:"text",class:"rounded mb-32 form-control",style:{width:"100%"},"onUpdate:modelValue":e[10]||(e[10]=s=>i.description=s),name:"description",id:"description"},null,512),[[r,i.description]])]),t("div",vt,[Ut,a(t("textarea",{type:"text",class:"rounded mb-32 form-control",style:{width:"100%"},"onUpdate:modelValue":e[11]||(e[11]=s=>i.content=s),name:"content",id:"content",rows:"10"},`
                      `,512),[[r,i.content]])]),t("div",wt,[xt,t("div",kt,[a(t("input",{class:"form-check-input",type:"checkbox",id:"flexSwitchCheckDefault","onUpdate:modelValue":e[12]||(e[12]=s=>i.is_enabled=s)},null,512),[[k,i.is_enabled]]),t("label",Pt,p(i.is_enabled?"產品公開":"產品不公開"),1)])])])])])],512)]),t("div",Mt,[Ct,i.product.id?(n(),l("button",{key:0,type:"button",class:"btn btn-primary",onClick:e[13]||(e[13]=s=>d.updateProduct("old",i.product.id))}," 修改產品 ")):(n(),l("button",{key:1,class:"btn btn-primary",onClick:e[14]||(e[14]=s=>d.updateProduct("new"))}," 新增產品 "))])])])],512)]),t("div",Vt,[m(f,{class:"",pagination:i.pagination,"get-page-products":d.getPageProducts},null,8,["pagination","get-page-products"])])],64)}const It=x(P,[["render",jt]]);export{It as default};
