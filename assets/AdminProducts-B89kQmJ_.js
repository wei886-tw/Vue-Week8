import{A as U}from"./AdminNavBar-CDM6vjKx.js";import{P as v}from"./PageNation-Cxqjbqse.js";import{m as w}from"./mixin-CE07gU2g.js";import{M as x}from"./modal-BhybSxHL.js";import{_ as k,l,j as t,i as m,F as u,v as g,G as a,H as r,I as P,y as p,k as _,e as n}from"./index-BNYnb7Rs.js";const M={components:{AdminNavBar:U,PageNation:v},mixins:[w],data(){return{allProducts:[],url:"https://vue3-course-api.hexschool.io",api_path:"wei123",pagination:{},myModal:"",product:"",title:"",category:"",origin_price:"",price:"",unit:"",description:"",content:"",is_enabled:!1,imageUrl:"",imagesUrl:[]}},methods:{getPageProducts(c=1){this.$http.get(`${this.url}/v2/api/${this.api_path}/admin/products?page=${c}`).then(s=>{this.pagination=s.data.pagination,this.allProducts=s.data.products,window.scrollTo(0,0)}).catch(s=>{alert(s.response.data.message)})},openModal(c,s){c==="old"?this.$http.get(`${this.url}/v2/api/${this.api_path}/product/${s}`).then(o=>{this.product=o.data.product,this.title=o.data.product.title,this.category=o.data.product.category,this.origin_price=parseInt(o.data.product.origin_price),this.price=parseInt(o.data.product.price),this.unit=o.data.product.unit,this.description=o.data.product.description,this.content=o.data.product.content,this.is_enabled=o.data.product.is_enabled,this.imageUrl=o.data.product.imageUrl,this.imagesUrl=o.data.product.imagesUrl,this.loadingCircle(),this.myModal.show()}).catch(o=>{console.log(o.response.data.message)}):(this.title="",this.category="",this.origin_price="",this.price="",this.unit="",this.description="",this.content="",this.is_enabled="",this.imageUrl="",this.imagesUrl="",this.myModal.show())},updateProduct(c,s){c==="old"?(this.openModal("old",s),this.$http.put(`${this.url}/v2/api/${this.api_path}/admin/product/${s}`,{data:{title:this.title,category:this.category,origin_price:this.origin_price,price:this.price,unit:this.unit,description:this.description,content:this.content,is_enabled:this.is_enabled,imageUrl:this.imageUrl,imagesUrl:this.imagesUrl}}).then(()=>{alert("產品修改成功"),this.title="",this.category="",this.origin_price="",this.price="",this.unit="",this.description="",this.content="",this.is_enabled="",this.imageUrl="",this.imagesUrl="",this.myModal.hide(),this.getPageProducts(1)}).catch(o=>{console.log(o.response.data.message)})):this.$http.post(`${this.url}/v2/api/${this.api_path}/admin/product/`,{data:{title:this.title,category:this.category,origin_price:this.origin_price,price:this.price,unit:this.unit,description:this.description,content:this.content,is_enabled:this.is_enabled,imageUrl:this.imageUrl,imagesUrl:this.imagesUrl}}).then(()=>{alert("建立產品成功"),this.loading(),this.getPageProducts(1),this.myModal.hide()}).catch(o=>{console.log(o.response.data.message)})},deleteProduct(c){this.$http.delete(`${this.url}/v2/api/${this.api_path}/admin/product/${c}`).then(()=>{alert("刪除產品成功"),this.loading(),this.getPageProducts(1)}).catch(s=>{console.log(s.response.data.message)})},imagesUrlPush(){this.imagesUrl=[],this.imagesUrl.push()},imagesUrlPop(){this.imagesUrl.pop()}},mounted(){this.getPageProducts(),this.loadingCircle(),this.myModal=new x(this.$refs.detailModal)}},C={class:"container-fluid px-0"},V={class:"container py-48"},j={class:"container d-flex justify-content-between px-0"},A=t("h2",{class:"text-start fs-16 fs-md-24 fs-lg-32 fw-bold"},"後台產品列表",-1),B={class:"table mt-4"},D=t("thead",null,[t("tr",null,[t("th",{width:"80"},"分類"),t("th",null,"產品名稱"),t("th",{width:"120"},"售價"),t("th",{width:"120"},"啟用與否"),t("th",{width:"150"},"修改產品內容"),t("th",{width:"150"},"刪除產品")])],-1),L={key:0,class:""},N={key:1,class:"text-danger"},I=["onClick"],S=["onClick"],F={class:"container"},T={class:"modal fade",id:"modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"detailModal"},E={class:"modal-dialog modal-xl"},G={class:"modal-content"},H={class:"modal-header bg-dark"},q={key:0,class:"modal-title fs-32 text-white",id:"exampleModalLabel"},z={key:1,class:"modal-title fs-32 text-white",id:"exampleModalLabel"},J=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),K={class:"modal-body"},O={ref:"form"},Q={class:"row justify-content-center"},R={class:"col-4"},W=t("label",{class:"fs-24 mb-8 fw-bold",for:"title"},"產品主圖網址",-1),X=["src"],Y=t("label",{class:"fs-24 mb-8 fw-bold",for:"title"},"產品多圖設置",-1),Z={key:0},$={class:"form-group"},tt=["for"],st=["id","onUpdate:modelValue"],et=["src"],it={key:0},ot={key:1},lt={key:1},nt={class:"col-8"},dt=t("label",{class:"fs-24 mb-8 fw-bold",for:"title"},"產品名稱",-1),at={class:"row justify-content-end"},rt={class:"col-6"},ct=t("label",{class:"fs-24 mb-8 fw-bold",for:"title"},"產品原價",-1),ht={class:"col-6"},pt=t("label",{class:"fs-24 mb-8 fw-bold",for:"title"},"產品特價",-1),ut={class:"row justify-content-end"},mt={class:"col-6"},gt=t("label",{class:"fs-24 mb-8 fw-bold",for:"title"},"產品單位",-1),_t={class:"col-6"},bt=t("label",{class:"fs-24 mb-8 fw-bold",for:"title"},"產品分類",-1),ft={class:"row justify-content-end"},yt={class:"col-12"},Ut=t("label",{class:"fs-24 mb-8 fw-bold",for:"title"},"產品描述",-1),vt={class:"col-12"},wt=t("label",{class:"fs-24 mb-8 fw-bold",for:"title"},"產品內容",-1),xt={class:"col-12"},kt=t("h3",{class:"fs-24 fw-bold"},"產品狀態",-1),Pt={class:"form-check form-switch"},Mt={class:"form-check-label",for:"flexSwitchCheckDefault"},Ct={class:"modal-footer"},Vt=t("button",{type:"button",class:"btn btn-secondary border","data-bs-dismiss":"modal"}," 關閉 ",-1),jt={class:"container d-flex justify-content-end"};function At(c,s,o,Bt,i,d){const b=_("admin-nav-bar"),f=_("page-nation");return n(),l(u,null,[t("div",C,[m(b)]),t("div",V,[t("div",j,[A,t("button",{class:"btn btn-dark",onClick:s[0]||(s[0]=e=>d.openModal("new"))},"建立新產品")]),t("table",B,[D,t("tbody",null,[(n(!0),l(u,null,g(i.allProducts,e=>(n(),l("tr",{key:e.id},[t("td",null,p(e.category),1),t("td",null,p(e.title),1),t("td",null,p(e.price),1),t("td",null,[e.is_enabled?(n(),l("span",L,"啟用")):(n(),l("span",N,"未啟用"))]),t("td",null,[t("button",{class:"btn btn-success",onClick:h=>d.openModal("old",e.id)}," 修改產品內容 ",8,I)]),t("td",null,[t("button",{class:"btn btn-danger",onClick:h=>d.deleteProduct(e.id)}," 刪除產品 ",8,S)])]))),128))])])]),t("div",F,[t("div",T,[t("div",E,[t("div",G,[t("div",H,[i.imagesUrl.length!==0?(n(),l("h1",q," 修改產品 ")):(n(),l("h1",z," 新增產品 ")),J]),t("div",K,[t("form",O,[t("div",Q,[t("div",R,[W,a(t("input",{type:"text",class:"rounded mb-32 form-control",style:{width:"100%",height:"40px"},"onUpdate:modelValue":s[1]||(s[1]=e=>i.imageUrl=e),name:"imageUrl",id:"imageUrl",placeholder:"請輸入網址"},null,512),[[r,i.imageUrl]]),t("img",{src:i.imageUrl,alt:"",width:"100%",style:{"object-fit":"cover"}},null,8,X),Y,Array.isArray(i.imagesUrl)?(n(),l("div",Z,[(n(!0),l(u,null,g(i.imagesUrl,(e,h)=>(n(),l("div",{class:"mb-8",key:h},[t("div",$,[t("label",{for:`imagesUrl${h}`,class:"form-label"},"圖片網址",8,tt),a(t("input",{id:`imagesUrl${h}`,"onUpdate:modelValue":y=>i.imagesUrl[h]=y,type:"text",class:"form-control",placeholder:"請輸入圖片連結"},null,8,st),[[r,i.imagesUrl[h]]])]),t("img",{class:"img-fluid",src:e},null,8,et)]))),128)),!i.imagesUrl.length||i.imagesUrl[i.imagesUrl.length-1]?(n(),l("div",it,[t("button",{class:"btn btn-primary btn-sm d-block w-100",onClick:s[2]||(s[2]=e=>i.imagesUrl.push(""))}," 新增圖片 ")])):(n(),l("div",ot,[t("button",{class:"btn btn-danger btn-sm d-block w-100",onClick:s[3]||(s[3]=(...e)=>d.imagesUrlPop&&d.imagesUrlPop(...e))}," 刪除圖片 ")]))])):(n(),l("div",lt,[t("button",{class:"btn btn-primary btn-sm d-block w-100",onClick:s[4]||(s[4]=(...e)=>d.imagesUrlPush&&d.imagesUrlPush(...e))}," 新增圖片 ")]))]),t("div",nt,[dt,a(t("input",{type:"text",class:"rounded mb-32 form-check-input",style:{width:"100%",height:"40px"},"onUpdate:modelValue":s[5]||(s[5]=e=>i.title=e),name:"title",id:"title"},null,512),[[r,i.title]]),t("div",at,[t("div",rt,[ct,a(t("input",{type:"number",class:"rounded mb-32 form-check-input",style:{width:"100%",height:"40px"},"onUpdate:modelValue":s[6]||(s[6]=e=>i.origin_price=e),name:"origin_price",id:"origin_price"},null,512),[[r,i.origin_price]])]),t("div",ht,[pt,a(t("input",{type:"number",class:"rounded mb-32 form-check-input",style:{width:"100%",height:"40px"},"onUpdate:modelValue":s[7]||(s[7]=e=>i.price=e),name:"price",id:"price"},null,512),[[r,i.price]])])]),t("div",ut,[t("div",mt,[gt,a(t("input",{type:"text",class:"rounded mb-32 form-check-input",style:{width:"100%",height:"40px"},"onUpdate:modelValue":s[8]||(s[8]=e=>i.unit=e),name:"unit",id:"unit"},null,512),[[r,i.unit]])]),t("div",_t,[bt,a(t("input",{type:"text",class:"rounded mb-32 form-check-input",style:{width:"100%",height:"40px"},"onUpdate:modelValue":s[9]||(s[9]=e=>i.category=e),name:"category",id:"category"},null,512),[[r,i.category]])])]),t("div",ft,[t("div",yt,[Ut,a(t("textarea",{type:"text",class:"rounded mb-32 form-control",style:{width:"100%"},"onUpdate:modelValue":s[10]||(s[10]=e=>i.description=e),name:"description",id:"description"},null,512),[[r,i.description]])]),t("div",vt,[wt,a(t("textarea",{type:"text",class:"rounded mb-32 form-control",style:{width:"100%"},"onUpdate:modelValue":s[11]||(s[11]=e=>i.content=e),name:"content",id:"content",rows:"10"},`
                      `,512),[[r,i.content]])]),t("div",xt,[kt,t("div",Pt,[a(t("input",{class:"form-check-input",type:"checkbox",id:"flexSwitchCheckDefault","onUpdate:modelValue":s[12]||(s[12]=e=>i.is_enabled=e)},null,512),[[P,i.is_enabled]]),t("label",Mt,p(i.is_enabled?"產品公開":"產品不公開"),1)])])])])])],512)]),t("div",Ct,[Vt,i.product.id?(n(),l("button",{key:0,type:"button",class:"btn btn-primary",onClick:s[13]||(s[13]=e=>d.updateProduct("old",i.product.id))}," 修改產品 ")):(n(),l("button",{key:1,class:"btn btn-primary",onClick:s[14]||(s[14]=e=>d.updateProduct("new"))}," 新增產品 "))])])])],512)]),t("div",jt,[m(f,{class:"",pagination:i.pagination,"get-page-products":d.getPageProducts},null,8,["pagination","get-page-products"])])],64)}const Ft=k(M,[["render",At]]);export{Ft as default};
//# sourceMappingURL=AdminProducts-B89kQmJ_.js.map
