import{N as y,P,c as d}from"./NavBar-DRlPF7dn.js";import{f as h}from"./favoriteStore-C-gHRJTU.js";import{_ as w,t as f,u as p,l as a,j as t,i as l,F as u,v as x,z as C,e as i,y as _,q as S,s as k,k as n}from"./index-CvSW9f6W.js";const L={props:["finalTotal"],data(){return{api_path:"wei123",url:"https://vue3-course-api.hexschool.io",selectValue:"",cartProducts:[],cartList:{},final_total:"",form:{user:{name:"",email:"",tel:"",address:""},message:"",qty:0},couponModal:"",onSale:!1,favoriteProducts:[]}},computed:{...f(h,["favoriteList"]),...f(d,["cartStore"])},components:{NavBar:y,PageFooter:P},methods:{...p(h,["getFavoriteList","setStorage"]),...p(d,["getCartList"]),backToShop(){this.$router.push("/userProduct")},loadingCircle(){let s=this.$loading.show({container:this.fullPage?null:this.$refs.formContainer,canCancel:!0,onCancel:this.onCancel});setTimeout(()=>{s.hide()},500)},getProduct(s){return this.$http.get(`${this.url}/v2/api/${this.api_path}/product/${s}`).then(e=>{if(this.favoriteProducts.indexOf(e.data.product)===-1)return e.data.product}).catch(e=>{console.log(e.response.data.message)})},async fetchFavoriteProducts(){try{const s=await Promise.all(this.favoriteList.map(e=>this.getProduct(e)));this.favoriteProducts=s.filter(Boolean)}catch(s){console.log(s.response.data.message)}},addToCart(s){this.$http.post(`${this.url}/v2/api/${this.api_path}/cart`,{data:{product_id:s,qty:1}}).then(()=>{alert("加入購物車成功"),this.favoriteProducts.splice(this.favoriteProducts.indexOf(s),1),this.favoriteList.splice(this.favoriteList.indexOf(s),1),this.setStorage(),this.getCartList()}).catch(e=>{console.log(e.response.data.message)})}},mounted(){this.loadingCircle(),this.getFavoriteList(),this.fetchFavoriteProducts(),window.scroll(0,0)}},r=s=>(S("data-v-80a67f9e"),s=s(),k(),s),$={class:"container-fluid px-0"},F={class:"container-fluid px-0",style:{"min-height":"100vh"}},T={class:"container"},B=r(()=>t("h2",{class:"text-center py-60 pb-16 fs-24 fs-lg-32"},"收藏列表",-1)),N={class:"container px-0"},I={key:0,class:"table table-responsive"},V=r(()=>t("thead",null,[t("tr",null,[t("th",{class:"fs-12 fs-md-24",style:{width:"10%"}},"X"),t("th",{class:"fs-12 fs-md-24",style:{width:"30%"}},"品名"),t("th",{class:"fs-12 fs-md-24 rwd"},"圖片"),t("th",{class:"fs-12 fs-md-24",style:{width:"20%"}},"價格"),t("th",{class:"fs-12 fs-md-24",style:{width:"20%"}},"加入購物車")])],-1)),q=r(()=>t("td",{class:"align-middle px-0"},[t("button",{class:"btn btn-white"},[t("i",{class:"bi bi-trash3-fill fs-md-24"})])],-1)),O={class:"fs-12 fs-sm-16 fs-md-24 align-middle"},j={class:"align-middle"},U=["src"],z={class:"align-middle fs-12 fs-sm-16 fs-md-24"},A={class:"align-middle"},D=["onClick"],E={key:1,class:"text-center fs-24"},M=r(()=>t("br",null,null,-1)),X={class:"container-fluid px-0"},G={class:"container-fluid"};function H(s,e,J,K,m,c){const v=n("NavBar"),g=n("PageFooter"),b=n("router-view");return i(),a(u,null,[t("div",$,[l(v)]),t("div",F,[t("div",T,[B,t("div",N,[s.favoriteList.length!==0?(i(),a("table",I,[V,t("tbody",null,[(i(!0),a(u,null,x(m.favoriteProducts,o=>(i(),a("tr",{key:o.id},[q,t("td",O,_(o.title),1),t("td",j,[t("img",{alt:"產品圖片",class:"rwd",src:o.imageUrl,style:{"object-fit":"cover"}},null,8,U)]),t("td",z,_(o.price),1),t("td",A,[t("button",{class:"btn btn-footer",onClick:Q=>c.addToCart(o.id)}," 加入購物車 ",8,D)])]))),128))])])):(i(),a("h2",E,[C(" 您的收藏列表沒有東西喔，請先加入商品！"),M,t("button",{class:"btn btn-gray mt-32",onClick:e[0]||(e[0]=(...o)=>c.backToShop&&c.backToShop(...o))}," 返回商品頁面 ")]))])])]),t("div",X,[l(g)]),t("div",G,[l(b)])],64)}const Z=w(L,[["render",H],["__scopeId","data-v-80a67f9e"]]);export{Z as default};
