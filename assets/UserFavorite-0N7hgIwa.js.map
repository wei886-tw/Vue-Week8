{"version":3,"file":"UserFavorite-0N7hgIwa.js","sources":["../../src/views/UserFavorite.vue"],"sourcesContent":["<template>\n  <div class=\"container-fluid px-0\">\n    <NavBar />\n  </div>\n\n  <div class=\"container-fluid px-0\" style=\"min-height: 100vh\">\n    <div class=\"container\">\n      <h2 class=\"text-center py-60 pb-16 fs-24 fs-lg-32\">收藏列表</h2>\n      <div class=\"container px-0\">\n        <table class=\"table table-responsive\" v-if=\"favoriteList.length !== 0\">\n          <thead>\n            <tr>\n              <th class=\"fs-12 fs-md-24\" style=\"width: 10%\">X</th>\n              <th class=\"fs-12 fs-md-24\" style=\"width: 30%\">品名</th>\n              <th class=\"fs-12 fs-md-24 rwd\">圖片</th>\n              <th class=\"fs-12 fs-md-24\" style=\"width: 20%\">價格</th>\n              <th class=\"fs-12 fs-md-24\" style=\"width: 20%\">加入購物車</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr v-for=\"product in favoriteProducts\" :key=\"product.id\">\n              <td class=\"align-middle px-0\">\n                <button\n                  class=\"btn btn-white\"\n                  @click=\"removeFavorite(product.id)\"\n                >\n                  <i class=\"bi bi-trash3-fill fs-md-24\"></i>\n                </button>\n              </td>\n              <td class=\"fs-12 fs-sm-16 fs-md-24 align-middle\">\n                {{ product.title }}\n              </td>\n              <td class=\"align-middle\">\n                <img\n                  alt=\"產品圖片\"\n                  class=\"rwd\"\n                  :src=\"product.imageUrl\"\n                  style=\"object-fit: cover\"\n                />\n              </td>\n              <td class=\"align-middle fs-12 fs-sm-16 fs-md-24\">\n                {{ product.price }}\n              </td>\n              <td class=\"align-middle\">\n                <button class=\"btn btn-footer\" @click=\"addToCart(product.id)\">\n                  加入購物車\n                </button>\n              </td>\n            </tr>\n          </tbody>\n        </table>\n\n        <h2 v-else class=\"text-center fs-24\">\n          您的收藏列表沒有東西喔，請先加入商品！<br />\n          <button class=\"btn btn-gray mt-32\" @click=\"backToShop\">\n            返回商品頁面\n          </button>\n        </h2>\n      </div>\n    </div>\n  </div>\n\n  <div class=\"container-fluid px-0\">\n    <PageFooter />\n  </div>\n\n  <div class=\"container-fluid\">\n    <router-view></router-view>\n  </div>\n</template>\n\n<script>\nimport NavBar from \"../components/NavBar.vue\";\nimport PageFooter from \"../components/PageFooter.vue\";\nimport favoriteStore from \"@/store/favoriteStore.js\";\nimport cartStore from \"@/store/cartStore.js\";\nimport { mapState, mapActions } from \"pinia\";\n\nexport default {\n  props: [\"finalTotal\"],\n  data() {\n    return {\n      api_path: import.meta.env.VITE_PATH,\n      url: import.meta.env.VITE_API,\n      selectValue: \"\",\n      cartProducts: [],\n      cartList: {},\n      final_total: \"\",\n      form: {\n        user: {\n          name: \"\",\n          email: \"\",\n          tel: \"\",\n          address: \"\",\n        },\n        message: \"\",\n        qty: 0,\n      },\n      couponModal: \"\",\n      onSale: false,\n      favoriteProducts: [],\n    };\n  },\n\n  computed: {\n    ...mapState(favoriteStore, [\"favoriteList\"]),\n    ...mapState(cartStore, [\"cartStore\"]),\n  },\n\n  components: { NavBar, PageFooter },\n\n  methods: {\n    ...mapActions(favoriteStore, [\"getFavoriteList\", \"setStorage\"]),\n    ...mapActions(cartStore, [\"getCartList\"]),\n\n    backToShop() {\n      this.$router.push(\"/userProduct\");\n    },\n\n    loadingCircle() {\n      let loader = this.$loading.show({\n        container: this.fullPage ? null : this.$refs.formContainer,\n        canCancel: true,\n        onCancel: this.onCancel,\n      });\n      setTimeout(() => {\n        loader.hide();\n      }, 500);\n    },\n\n    getProduct(id) {\n      return this.$http\n        .get(`${this.url}/v2/api/${this.api_path}/product/${id}`)\n        .then((res) => {\n          if (this.favoriteProducts.indexOf(res.data.product) === -1) {\n            return res.data.product;\n          }\n        })\n        .catch((err) => {\n          console.log(err.response.data.message);\n        });\n    },\n\n    async fetchFavoriteProducts() {\n      try {\n        const products = await Promise.all(\n          this.favoriteList.map((id) => this.getProduct(id))\n        );\n        this.favoriteProducts = products.filter(Boolean); // 過濾掉任何 undefined 或 null 值\n      } catch (err) {\n        console.log(err.response.data.message);\n      }\n    },\n\n    addToCart(id) {\n      this.$http\n        .post(`${this.url}/v2/api/${this.api_path}/cart`, {\n          data: {\n            product_id: id,\n            qty: 1,\n          },\n        })\n        .then(() => {\n          alert(\"加入購物車成功\");\n          this.favoriteProducts.splice(this.favoriteProducts.indexOf(id), 1);\n          this.favoriteList.splice(this.favoriteList.indexOf(id), 1);\n          this.setStorage();\n          this.getCartList();\n        })\n        .catch((err) => {\n          console.log(err.response.data.message);\n        });\n    },\n\n    removeFavorite(id) {\n      this.favoriteProducts.splice(this.favoriteProducts.indexOf(id), 1);\n      this.favoriteList.splice(this.favoriteList.indexOf(id), 1);\n      this.setStorage();\n      this.getCartList();\n      window.scroll(0, 0);\n    },\n  },\n\n  mounted() {\n    this.loadingCircle();\n    this.getFavoriteList();\n    this.fetchFavoriteProducts();\n    window.scroll(0, 0);\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\nbutton:hover {\n  background-color: black;\n  color: white;\n}\n\ninput {\n  @media (max-width: 576px) {\n    width: 40px;\n  }\n  @media (min-width: 577px) {\n    width: 60px;\n  }\n}\n\nimg.rwd {\n  @media (max-width: 576px) {\n    width: 80px;\n    height: 80px;\n  }\n  @media (min-width: 577px) {\n    width: 100px;\n    height: 100px;\n  }\n  @media (min-width: 768px) {\n    width: 160px;\n    height: 160px;\n  }\n  @media (min-width: 976px) {\n    width: 200px;\n    height: 200px;\n  }\n}\n\ntd.rwd {\n  @media (max-width: 576px) {\n    width: 80px;\n    height: 80px;\n  }\n  @media (min-width: 577px) {\n    width: 100px;\n    height: 100px;\n  }\n  @media (min-width: 768px) {\n    width: 160px;\n    height: 160px;\n  }\n  @media (min-width: 976px) {\n    width: 200px;\n    height: 200px;\n  }\n}\n</style>\n"],"names":["_sfc_main","mapState","favoriteStore","cartStore","NavBar","PageFooter","mapActions","loader","id","res","err","products","_hoisted_1","_hoisted_3","_hoisted_4","_withScopeId","_createElementVNode","_hoisted_5","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_20","_hoisted_21","_openBlock","_createElementBlock","_Fragment","_createVNode","_component_NavBar","_hoisted_2","_ctx","_hoisted_6","_hoisted_7","_renderList","$data","product","$event","$options","_hoisted_11","_toDisplayString","_hoisted_18","_createTextVNode","_hoisted_19","args","_component_PageFooter","_component_router_view"],"mappings":"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"}