import{A as g}from"./AdminNavBar-BlCaqaxm.js";import{P as v}from"./PageNation-CykBehZV.js";import{_ as y,c,b as r,a as t,F as h,f as C,i,v as d,l as M,r as p,o as u,g as a}from"./index-BA_JWqmO.js";const k={components:{AdminNavBar:g,PageNation:v},data(){return{api_path:"wei123",url:"https://vue3-course-api.hexschool.io",title:"",is_enabled:!0,percent:"",due_date:"",code:"",myModal:"",coupons:"",couponPagination:"",date:""}},methods:{createCoupon(){this.due_date=parseInt(new Date(this.$refs.date.value).getTime()),this.is_enabled===!0?this.is_enabled=1:this.is_enabled=0,this.$http.post(`${this.url}/v2/api/${this.api_path}/admin/coupon`,{data:{title:this.title,is_enabled:this.is_enabled,percent:this.percent,due_date:this.due_date,code:this.code}}).then(()=>{alert("建立優惠券成功"),this.$refs.form.reset(),this.myModal.hide(),this.getCoupons(1)}).catch(n=>{console.log(n.response.data.message)})},openModal(){this.myModal.show()},closeModal(){this.myModal.hide()},getCoupons(n){this.$http.get(`${this.url}/v2/api/${this.api_path}/admin/coupons?page=${n}`).then(o=>{this.coupons=o.data.coupons,this.couponPagination=o.data.pagination}).catch(o=>{console.log(o.response.data.message)})},adviseCoupon(n){this.$http.put(`${this.url}/v2/api/${this.api_path}/admin/coupon/${n}`,{data:{title:this.title,is_enabled:this.is_enabled,percent:this.percent,due_date:this.due_date}}).then(()=>{this.myModal.show()}).catch(o=>{console.log(o.response.data.message)})},deleteCoupon(n){this.$http.delete(`${this.url}/v2/api/${this.api_path}/admin/coupon/${n}`).then(()=>{alert("已刪除優惠券"),this.getCoupons(1)})}},mounted(){this.myModal=new bootstrap.Modal(this.$refs.couponModal),this.getCoupons(1)}},w={class:"container-fluid px-0"},x={class:"container py-48"},D={class:"container d-flex justify-content-between mb-24"},V=t("h2",{class:"fs-32"},"優惠券管理",-1),P={class:"table mb-16"},U=t("thead",null,[t("tr",null,[t("th",{scope:"col"},"優惠券標題"),t("th",{scope:"col"},"折價"),t("th",{scope:"col"},"到期日"),t("th",{scope:"col"},"是否啟用"),t("th",{scope:"col"},"修改"),t("th",{scope:"col"},"刪除")])],-1),$=["onClick"],B=["onClick"],N={class:"container"},A={class:"modal",tabindex:"-1",ref:"couponModal"},F={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable"},j={class:"modal-content"},T=t("div",{class:"modal-header"},[t("h5",{class:"modal-title"},"建立優惠券"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),E={class:"modal-body"},I={action:"",ref:"form"},L={class:"form-group mb-16"},S=t("label",{for:"title",class:"form-label"},"優惠券名稱",-1),Y={class:"form-group mb-16"},q=t("label",{for:"percent",class:"form-label"},"折扣",-1),z={class:"form-group mb-16"},G=t("label",{for:"due_date",class:"form-label"},"到期日",-1),H={class:"form-group mb-16"},J=t("label",{for:"code",class:"form-label"},"優惠券代碼",-1),K={class:"form-check form-switch mb-16"},O=t("label",{for:"is_enabled",class:"form-check-label"},"是否啟用優惠券",-1),Q={class:"modal-footer"},R={class:"container"};function W(n,o,X,Z,s,l){const _=p("admin-nav-bar"),m=p("page-nation"),b=p("router-view");return u(),c(h,null,[r(_),t("div",w,[t("div",x,[t("div",D,[V,t("button",{type:"button",class:"btn btn-dark",onClick:o[0]||(o[0]=e=>l.openModal(""))}," 建立優惠券 ")]),t("table",P,[U,t("tbody",null,[(u(!0),c(h,null,C(s.coupons,e=>(u(),c("tr",{key:e.id},[t("td",null,a(e.title),1),t("td",null,a(e.percent)+" 折",1),t("td",null,a(new Date(e.due_date).getFullYear())+"/ "+a(new Date(e.due_date).getMonth())+"/ "+a(new Date(e.due_date).getDate()),1),t("td",null,a(e.is_enabled?"是":"否"),1),t("td",null,[t("button",{class:"btn btn-success",onClick:f=>l.adviseCoupon(e.id)}," 修改優惠券 ",8,$)]),t("td",null,[t("button",{class:"btn btn-danger",onClick:f=>l.deleteCoupon(e.id)}," 刪除優惠券 ",8,B)])]))),128))])]),t("div",N,[r(m,{pagination:s.couponPagination,"get-page-products":l.getCoupons,class:"d-flex justify-content-end"},null,8,["pagination","get-page-products"])])])]),t("div",A,[t("div",F,[t("div",j,[T,t("div",E,[t("form",I,[t("div",L,[S,i(t("input",{id:"title","onUpdate:modelValue":o[1]||(o[1]=e=>s.title=e),type:"text",class:"form-control",placeholder:"請輸入優惠券名稱"},null,512),[[d,s.title]])]),t("div",Y,[q,i(t("input",{id:"percent","onUpdate:modelValue":o[2]||(o[2]=e=>s.percent=e),type:"number",class:"form-control",placeholder:"請輸入折扣"},null,512),[[d,s.percent]])]),t("div",z,[G,i(t("input",{id:"due_date","onUpdate:modelValue":o[3]||(o[3]=e=>s.date=e),type:"date",class:"form-control",placeholder:"請輸入到期日",ref:"date"},null,512),[[d,s.date]])]),t("div",H,[J,i(t("input",{id:"code","onUpdate:modelValue":o[4]||(o[4]=e=>s.code=e),type:"text",class:"form-control",placeholder:"請輸入優惠券代碼"},null,512),[[d,s.code]])]),t("div",K,[O,i(t("input",{id:"is_enabled","onUpdate:modelValue":o[5]||(o[5]=e=>s.is_enabled=e),type:"checkbox",class:"form-check-input"},null,512),[[M,s.is_enabled]])])],512)]),t("div",Q,[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal",onClick:o[6]||(o[6]=(...e)=>l.closeModal&&l.closeModal(...e))}," 關閉 "),t("button",{type:"button",class:"btn btn-primary",onClick:o[7]||(o[7]=(...e)=>l.createCoupon&&l.createCoupon(...e))}," 建立優惠券 ")])])])],512),t("div",R,[r(b)])],64)}const st=y(k,[["render",W]]);export{st as default};
