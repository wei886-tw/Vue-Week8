import{N as k,P,c as b}from"./NavBar-Bp8jkuDl.js";import{_ as M,t as V,u as N,l as c,j as t,i as d,F as p,v,y as u,z as L,x as g,g as q,k as h,e as r,A as f,q as S,s as T}from"./index-CoJQpvir.js";const I={props:["finalTotal"],data(){return{api_path:"wei123",url:"https://vue3-course-api.hexschool.io",selectValue:"",cartProducts:[],cartList:{},final_total:"",form:{user:{name:"",email:"",tel:"",address:""},message:"",qty:0},couponModal:""}},computed:{...V(b,["storeCart"])},components:{NavBar:k,PageFooter:P},methods:{getCartProducts(){this.$http.get(`${this.url}/v2/api/${this.api_path}/cart`).then(s=>{this.cartProducts=s.data.data.carts,this.cartList=s.data.data}).catch(s=>{console.log(s.response.data.message)})},reviseQty(s){this.qty=parseInt(event.target.value),this.$http.put(`${this.url}/v2/api/${this.api_path}/cart/${s}`,{data:{product_id:s,qty:this.qty}}).then(()=>{alert("修改購物車成功"),this.getCartProducts(),this.getCartList()}).catch(o=>{console.log(o.response.data.message)})},delCartItem(s){this.$http.delete(`${this.url}/v2/api/${this.api_path}/cart/${s}`).then(()=>{alert("已經刪除"),this.getCartProducts(),this.getCartList()}).cath(o=>{console.log(o.message)})},enterPayment(){this.$router.push("/userOrder"),window.scrollTo(0,0),this.$emit("emit-cart-list",this.cartList)},backToShop(){this.$router.push("/userProduct")},showCouponModal(){this.couponModal.show()},getCoupon(){this.form.user.name!==""&&this.form.user.email!==""&&this.form.user.phone!==""?this.$http.post(`${this.url}/v2/api/${this.api_path}/coupon`,{data:{code:"test7"}}).then(()=>{alert("已套用優惠券，幫您打 77 折！"),this.couponModal.hide()}).catch(s=>{console.log(s.response.data.message)}):alert("請輸入資料已獲取優惠券")},loadingCircle(){let s=this.$loading.show({container:this.fullPage?null:this.$refs.formContainer,canCancel:!0,onCancel:this.onCancel});setTimeout(()=>{s.hide()},500)},isPhone(s){return/^(09)[0-9]{8}$/.test(s)?!0:"需要正確的電話號碼"},...N(b,["getCartList"])},mounted(){this.getCartProducts(),this.loadingCircle(),this.couponModal=new bootstrap.Modal(this.$refs.couponModal)}},l=s=>(S("data-v-b54fa680"),s=s(),T(),s),B={class:"container-fluid px-0"},j={class:"container-fluid px-0",style:{"min-height":"100vh"}},F={class:"container"},U=l(()=>t("h2",{class:"text-center py-60 pb-16 fs-24 fs-lg-32"},"購物車列表",-1)),$={class:"container px-0"},E={key:0,class:"table table-responsive"},z=l(()=>t("thead",null,[t("tr",null,[t("th",{class:"fs-12 fs-md-24",style:{width:"10%"}},"X"),t("th",{class:"fs-12 fs-md-24",style:{width:"30%"}},"品名"),t("th",{class:"fs-12 fs-md-24 rwd"},"圖片"),t("th",{class:"fs-12 fs-md-24",style:{width:"20%"}},"數量"),t("th",{class:"fs-12 fs-md-24",style:{width:"20%"}},"價格")])],-1)),A={class:"align-middle"},Q=["onClick"],D={class:"fs-12 fs-sm-16 fs-md-24 align-middle"},O={class:"align-middle"},X=["src"],G={class:"align-middle"},H=["onChange"],J=["value","selected"],K={class:"fs-12 fs-sm-16 fs-md-24 align-middle"},R=l(()=>t("td",null,null,-1)),W=l(()=>t("td",null,null,-1)),Y=l(()=>t("td",null,null,-1)),Z=l(()=>t("td",null,null,-1)),tt={class:"fs-12 fs-md-16 fs-lg-24 pt-32"},st={class:"container d-lg-flex flex-column justify-content-between"},et={class:"container px-0 d-md-flex"},ot=l(()=>t("p",null,"原價: ",-1)),lt={class:"mb-16"},at={class:"container px-0 d-md-flex"},nt=l(()=>t("p",null,"優惠: ",-1)),it={key:1,class:"text-center fs-24"},dt=l(()=>t("br",null,null,-1)),ct={class:"container px-0"},rt={class:"row"},ht=l(()=>t("div",{class:"col-6"},[t("div",{class:"container d-flex px-0 justify-content-start"})],-1)),ut={class:"col-6"},mt={class:"container px-0 justify-content-end d-flex"},_t={class:"container d-flex px-0 justify-content-end"},pt={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"couponModal"},ft={class:"modal-dialog modal-dialog-centered modal-lg"},bt={class:"modal-content"},vt=l(()=>t("div",{class:"modal-header"},[t("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"領取優惠券"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),gt={class:"modal-body"},yt=l(()=>t("p",{class:"mb-16"}," 請填寫 Email 及姓名、電話等獲取優惠，我們將不定時發送優惠給您！ ",-1)),Ct={class:"mb-12"},xt=l(()=>t("label",{for:"email",class:"form-label"},null,-1)),wt={class:"mb-12"},kt=l(()=>t("label",{for:"inputName",class:"form-label"},null,-1)),Pt={class:"mb-12"},Mt=l(()=>t("label",{for:"inputTelephone",class:"form-label"},null,-1)),Vt={class:"modal-footer"},Nt=l(()=>t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," 取消 ",-1)),Lt={class:"container-fluid px-0"},qt={class:"container-fluid"};function St(s,o,Tt,It,a,i){const y=h("NavBar"),m=h("v-field"),_=h("error-message"),C=h("v-form"),x=h("PageFooter"),w=h("router-view");return r(),c(p,null,[t("div",B,[d(y)]),t("div",j,[t("div",F,[U,t("div",$,[a.cartProducts.length!==0?(r(),c("table",E,[z,t("tbody",null,[(r(!0),c(p,null,v(a.cartProducts,e=>(r(),c("tr",{key:e.id},[t("td",A,[t("i",{class:"bi bi-trash3-fill fs-md-24",onClick:n=>i.delCartItem(e.id)},null,8,Q)]),t("td",D,u(e.product.title),1),t("td",O,[t("img",{src:e.product.imageUrl,alt:"產品圖片",class:"rwd"},null,8,X)]),t("td",G,[t("select",{name:"",id:"",onChange:n=>i.reviseQty(e.id),class:"border border-3 border-dark rounded",style:{height:"40px",width:"100%"}},[(r(),c(p,null,v(10,n=>t("option",{value:n,key:n,selected:n===e.qty},u(n),9,J)),64))],40,H)]),t("td",K,u(Math.floor(parseInt(e.product.price*e.qty))),1)]))),128))]),t("tfoot",null,[R,W,Y,Z,t("td",tt,[t("div",st,[t("div",et,[ot,t("del",null,[t("p",lt,u(Math.floor(a.cartList.total)),1)])]),t("div",at,[nt,t("p",null,u(Math.floor(a.cartList.final_total)),1)])])])])])):(r(),c("h2",it,[L(" 您的購物車沒有東西喔，請先加入商品！"),dt,t("button",{class:"btn btn-gray mt-32",onClick:o[0]||(o[0]=(...e)=>i.backToShop&&i.backToShop(...e))}," 返回商品頁面 ")])),t("div",ct,[t("div",rt,[ht,t("div",ut,[t("div",mt,[a.cartProducts.length!==0?(r(),c("button",{key:0,type:"button",class:"btn w-50 mb-32 btn-footer",onClick:o[1]||(o[1]=(...e)=>i.showCouponModal&&i.showCouponModal(...e))}," 領取優惠 ")):g("",!0)]),t("div",_t,[a.cartProducts.length!==0?(r(),c("button",{key:0,type:"button",class:"btn w-50 mb-60 btn-footer",onClick:o[2]||(o[2]=(...e)=>i.enterPayment&&i.enterPayment(...e))}," 進入付款頁面 ")):g("",!0)])])])])])])]),t("div",pt,[t("div",ft,[t("div",bt,[vt,t("div",gt,[yt,d(C,{ref:"form",id:"form"},{default:q(({errors:e})=>[t("div",Ct,[xt,d(m,{id:"email",name:"email",type:"email",class:f(["form-control w-100",{"is-invalid":e.email}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:a.form.user.email,"onUpdate:modelValue":o[3]||(o[3]=n=>a.form.user.email=n)},null,8,["class","modelValue"]),d(_,{name:"email",class:"invalid-feedback"})]),t("div",wt,[kt,d(m,{type:"text",class:f(["form-control w-100",{"is-invalid":e.姓名}]),id:"inputName",name:"姓名",placeholder:"請輸入姓名",rules:"required",modelValue:a.form.user.name,"onUpdate:modelValue":o[4]||(o[4]=n=>a.form.user.name=n)},null,8,["class","modelValue"]),d(_,{name:"姓名",class:"invalid-feedback"})]),t("div",Pt,[Mt,d(m,{type:"tel",class:f(["form-control w-100",{"is-invalid":e.電話}]),id:"inputTelephone",name:"電話",placeholder:"請輸入電話",rules:i.isPhone,modelValue:a.form.user.tel,"onUpdate:modelValue":o[5]||(o[5]=n=>a.form.user.tel=n)},null,8,["class","rules","modelValue"]),d(_,{name:"電話",class:"invalid-feedback"})])]),_:1},512)]),t("div",Vt,[Nt,t("button",{type:"button",class:"btn btn-primary",onClick:o[6]||(o[6]=(...e)=>i.getCoupon&&i.getCoupon(...e))}," 領取優惠 ")])])])],512),t("div",Lt,[d(x)]),t("div",qt,[d(w)])],64)}const Ft=M(I,[["render",St],["__scopeId","data-v-b54fa680"]]);export{Ft as default};
