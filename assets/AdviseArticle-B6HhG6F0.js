import{A as x}from"./AdminNavBar-BViuC8EG.js";import{M as U}from"./modal-C_hTNgSi.js";import{_ as b,e as n,l as c,j as t,J as k,x as w,G as d,H as r,F as v,i as _,A as h,E as g,I as $,y as I,k as f,q as M,s as A}from"./index-oONwyl3N.js";import{m as C}from"./mixin-CE07gU2g.js";const V={emits:["emitImgUrl"],data(){return{api:"https://vue3-course-api.hexschool.io",api_path:"wei123",myModal:"",imageUrl:"",isCover:!1}},methods:{checkAdmin(){const i=`${this.api}/api/user/check`;this.$http.post(i).then(()=>{}).catch(e=>{alert(e.response.data.message),this.$router.push("/adminLogin")})},submitImgUrl(){const e=this.$refs.dropArea.files[0],m=new FormData;m.append("file-to-upload",e),this.$http.post(`${this.api}/v2/api/${this.api_path}/admin/upload`,m).then(p=>{this.imageUrl=p.data.imageUrl,this.$emit("emitImgUrl",this.imageUrl),this.imageUrl="",this.myModal.hide()}).catch(p=>{console.log(p.response.data.message)})}},mounted(){const i=document.cookie.replace(/(?:(?:^|.*;\s*)hexToken\s*=\s*([^;]*).*$)|^.*$/,"$1");this.$http.defaults.headers.common.Authorization=i,this.checkAdmin(),this.myModal=new U(this.$refs.uploadImageModal)}},j={type:"button",class:"btn btn-gray w-100","data-bs-toggle":"modal","data-bs-target":"#exampleModal",ref:"btn"},B={ref:"uploadImageModal",class:"modal fade","aria-hidden":"true",id:"exampleModal","aria-labelledby":"uploadImageModal",tabindex:"-1"},N={class:"modal-dialog modal-lg modal-dialog-centered"},P={class:"modal-content"},S={class:"modal-header"},T={key:0,class:"modal-title text-bold fw-bold"},D={key:1,class:"modal-title text-bold fw-bold"},E=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),F={class:"modal-body container"},z={class:"row g-16"},q={class:"col-12 col-md-4"},G={class:"drop-area ratio-1x1"},H=["src"],J={key:2},L={class:"col-12 col-md-8"},K=t("p",{class:"mb-16"}," 僅限使用 jpg、jpeg 與 png 格式，檔案大小限制為 3MB 以下 ",-1),O={ref:"imgForm"},Q={class:"form-control",type:"file",ref:"dropArea",name:"file-to-upload"},R={class:"modal-footer"};function W(i,e,m,p,s,a){return n(),c(v,null,[t("button",j," 上傳圖片 ",512),t("div",B,[t("div",N,[t("div",P,[t("div",S,[s.isCover?(n(),c("h5",T,"上傳封面")):(n(),c("h5",D,"上傳圖片")),E]),t("div",F,[t("div",z,[t("div",q,[t("div",G,[s.imageUrl?(n(),c("div",{key:0,style:k(`background-image:url(${s.imageUrl})`),class:"w-100 h-100"},null,4)):w("",!0),s.imageUrl?(n(),c("img",{key:1,src:s.imageUrl,alt:"picture",style:{width:"250px","object-fit":"cover"}},null,8,H)):(n(),c("p",J,"圖片預覽"))])]),t("div",L,[K,t("form",O,[d(t("input",{class:"form-control mb-16",type:"text",ref:"imgInput",id:"test",placeholder:"請填入圖片網址","onUpdate:modelValue":e[0]||(e[0]=u=>s.imageUrl=u)},null,512),[[r,s.imageUrl]]),t("input",Q,null,512)],512)])])]),t("div",R,[t("button",{type:"button",class:"btn btn-dark",onClick:e[1]||(e[1]=(...u)=>a.submitImgUrl&&a.submitImgUrl(...u))}," 送出 ")])])])],512)],64)}const X=b(V,[["render",W]]),Y={props:["id"],mixins:[C],components:{AdminNavBarVue:x,UploadImageModalVue:X},data(){return{myModal:null,tempArticleInfo:{imageUrl:""},imageUrl:"",title:"",content:"",author:"",tag:[],description:"",articleCategory:"",isPublic:!0,create_at:"",url:"https://vue3-course-api.hexschool.io",api_path:"wei123"}},methods:{getUrl(i){this.imageUrl=i},getArticle(i){this.$http.get(`${this.url}/v2/api/${this.api_path}/admin/article/${i}`).then(e=>{this.article=e.data.article,this.title=e.data.article.title,this.create_at=e.data.article.create_at,this.description=e.data.article.description,this.isPublic=e.data.article.isPublic,this.tag=e.data.article.tag,this.author=e.data.article.author,this.content=e.data.article.content,this.imageUrl=e.data.article.image}).catch(e=>{console.log(e.response.data.message)})},adviseArticle(i){this.$http.put(`${this.url}/v2/api/${this.api_path}/admin/article/${i}`,{data:{title:this.title,description:this.description,image:this.imageUrl,tag:this.tag,create_at:this.create_at,author:this.author,isPublic:this.isPublic,content:this.content}}).then(()=>{alert("修改文章成功"),this.$router.push("/adminBlog")}).catch(e=>{console.log(e.response.data.message)})},addTag(i){this.tag===void 0?this.tag=i:this.tag.search(i)===-1&&this.tag.length!==0&&(this.tag=this.tag.concat("、",i))}},mounted(){this.getArticle(this.id),this.getUrl(),this.loadingCircle()}},l=i=>(M("data-v-a02b5865"),i=i(),A(),i),Z={class:"container-fluid"},tt={class:"container py-48",id:"id"},et=l(()=>t("h2",{class:"fs-40 mb-32 text-center"},"修改文章",-1)),st={ref:"form"},it={class:"row justify-content-center"},ot={class:"col-10"},at=l(()=>t("label",{class:"fs-24 mb-8",for:"title"},[h("文章標題"),t("span",{class:"text-danger"},"*")],-1)),lt={class:"row mb-32 justify-content-center"},nt={class:"col-5"},ct=l(()=>t("label",{class:"fs-24",for:"author"},[h(" 文章作者"),t("span",{class:"text-danger"},"*")],-1)),dt={class:"col-5"},rt=l(()=>t("label",{class:"fs-24",for:"articleCategory"},[h(" 文章分類"),t("span",{class:"text-danger"},"*")],-1)),ht={class:"col-10"},mt=l(()=>t("label",{class:"fs-24",for:"description"},[h("文章簡述"),t("span",{class:"text-danger"},"*")],-1)),pt=l(()=>t("label",{class:"fs-24",for:"description"},[h("文章內容"),t("span",{class:"text-danger"},"*")],-1)),ut={class:"row justify-content-center"},gt={class:"col-5 d-flex flex-column justify-content-between align-items-start"},_t=l(()=>t("h3",{class:"fs-24"},"文章發佈狀態",-1)),ft={class:"form-check form-switch"},bt={class:"form-check-label",for:"flexSwitchCheckDefault"},vt={class:"col-5"},yt=l(()=>t("p",{class:"fs-24"},"圖片預覽",-1)),xt=["src"];function Ut(i,e,m,p,s,a){const u=f("AdminNavBarVue"),y=f("UploadImageModalVue");return n(),c(v,null,[_(u),t("div",Z,[t("div",tt,[et,t("form",st,[t("div",it,[t("div",ot,[at,d(t("input",{type:"text",class:"rounded mb-32 form-check-input",style:{width:"100%",height:"40px"},"onUpdate:modelValue":e[0]||(e[0]=o=>s.title=o),name:"title",id:"title"},null,512),[[r,s.title]])])]),t("div",lt,[t("div",nt,[ct,d(t("input",{type:"text",class:"rounded mb-32 form-check-input",style:{width:"100%",height:"40px"},placeholder:"請填入作者",name:"author",id:"author","onUpdate:modelValue":e[1]||(e[1]=o=>s.author=o)},null,512),[[r,s.author]])]),t("div",dt,[rt,d(t("input",{type:"text",class:"rounded mb-16 form-check-input",style:{width:"100%",height:"40px"},placeholder:"請填入文章分類",name:"articleCategory",id:"articleCategory","onUpdate:modelValue":e[2]||(e[2]=o=>s.tag=o)},null,512),[[r,s.tag]]),t("p",null,[h(" 點擊帶入文章分類： "),t("button",{class:"btn btn-gray me-8",onClick:e[3]||(e[3]=g(o=>a.addTag("最新消息"),["prevent"]))}," 最新消息 "),t("button",{class:"btn btn-gray me-8",onClick:e[4]||(e[4]=g(o=>a.addTag("活動消息"),["prevent"]))}," 活動消息 "),t("button",{class:"btn btn-gray me-8",onClick:e[5]||(e[5]=g(o=>a.addTag("本站獨家"),["prevent"]))}," 本站獨家 ")])]),t("div",ht,[mt,d(t("textarea",{"onUpdate:modelValue":e[6]||(e[6]=o=>s.description=o),class:"rounded mb-24 form-check-input",style:{width:"100%",height:"120px"},placeholder:"請填入 100 字內描述",name:"description",id:"description"},null,512),[[r,s.description]]),pt,d(t("textarea",{type:"text","onUpdate:modelValue":e[7]||(e[7]=o=>s.content=o),class:"rounded mb-24 form-check-input",style:{width:"100%",height:"240px"},placeholder:"請輸入文章內容",name:"content",id:"content"},null,512),[[r,s.content]])])]),t("div",ut,[t("div",gt,[_t,t("div",ft,[d(t("input",{class:"form-check-input",type:"checkbox",id:"flexSwitchCheckDefault","onUpdate:modelValue":e[8]||(e[8]=o=>s.isPublic=o)},null,512),[[$,s.isPublic]]),t("label",bt,I(s.isPublic?"文章公開":"文章不公開"),1)]),_(y,{onEmitImgUrl:a.getUrl},null,8,["onEmitImgUrl"]),t("button",{type:"button",class:"btn btn-gray w-100",onClick:e[9]||(e[9]=o=>a.adviseArticle(m.id))}," 修改文章 ")]),t("div",vt,[yt,t("img",{src:s.imageUrl,alt:"",style:{width:"416px",height:"440px","object-fit":"cover"}},null,8,xt)])])],512)])])],64)}const Mt=b(Y,[["render",Ut],["__scopeId","data-v-a02b5865"]]);export{Mt as default};
//# sourceMappingURL=AdviseArticle-B6HhG6F0.js.map
