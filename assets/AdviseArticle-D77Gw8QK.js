import{A as x}from"./AdminNavBar-wDUJC4UW.js";import{_ as b,e as n,l as c,j as t,J as U,x as k,G as d,H as r,F as v,i as _,z as h,E as g,I as w,y as $,k as f,q as I,s as A}from"./index-B7jvjKL2.js";const C={emits:["emitImgUrl"],data(){return{api:"https://vue3-course-api.hexschool.io",api_path:"wei123",myModal:"",imageUrl:"",isCover:!1}},methods:{checkAdmin(){const o=`${this.api}/api/user/check`;this.$http.post(o).then(()=>{}).catch(e=>{alert(e.response.data.message),this.$router.push("/adminLogin")})},submitImgUrl(){const e=this.$refs.dropArea.files[0],m=new FormData;m.append("file-to-upload",e),this.$http.post(`${this.api}/v2/api/${this.api_path}/admin/upload`,m).then(p=>{this.imageUrl=p.data.imageUrl,this.$emit("emitImgUrl",this.imageUrl),this.imageUrl="",this.myModal.hide()}).catch(p=>{console.log(p.response.data.message)})}},mounted(){const o=document.cookie.replace(/(?:(?:^|.*;\s*)hexToken\s*=\s*([^;]*).*$)|^.*$/,"$1");this.$http.defaults.headers.common.Authorization=o,this.checkAdmin(),this.myModal=new bootstrap.Modal(this.$refs.uploadImageModal)}},M={type:"button",class:"btn btn-gray w-100","data-bs-toggle":"modal","data-bs-target":"#exampleModal",ref:"btn"},V={ref:"uploadImageModal",class:"modal fade","aria-hidden":"true",id:"exampleModal","aria-labelledby":"uploadImageModal",tabindex:"-1"},j={class:"modal-dialog modal-lg modal-dialog-centered"},B={class:"modal-content"},N={class:"modal-header"},P={key:0,class:"modal-title text-bold fw-bold"},S={key:1,class:"modal-title text-bold fw-bold"},T=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),D={class:"modal-body container"},E={class:"row g-16"},F={class:"col-12 col-md-4"},z={class:"drop-area ratio-1x1"},q=["src"],G={key:2},H={class:"col-12 col-md-8"},J=t("p",{class:"mb-16"}," 僅限使用 jpg、jpeg 與 png 格式，檔案大小限制為 3MB 以下 ",-1),L={ref:"imgForm"},K={class:"form-control",type:"file",ref:"dropArea",name:"file-to-upload"},O={class:"modal-footer"};function Q(o,e,m,p,s,a){return n(),c(v,null,[t("button",M," 上傳圖片 ",512),t("div",V,[t("div",j,[t("div",B,[t("div",N,[s.isCover?(n(),c("h5",P,"上傳封面")):(n(),c("h5",S,"上傳圖片")),T]),t("div",D,[t("div",E,[t("div",F,[t("div",z,[s.imageUrl?(n(),c("div",{key:0,style:U(`background-image:url(${s.imageUrl})`),class:"w-100 h-100"},null,4)):k("",!0),s.imageUrl?(n(),c("img",{key:1,src:s.imageUrl,alt:"picture",style:{width:"250px","object-fit":"cover"}},null,8,q)):(n(),c("p",G,"圖片預覽"))])]),t("div",H,[J,t("form",L,[d(t("input",{class:"form-control mb-16",type:"text",ref:"imgInput",id:"test",placeholder:"請填入圖片網址","onUpdate:modelValue":e[0]||(e[0]=u=>s.imageUrl=u)},null,512),[[r,s.imageUrl]]),t("input",K,null,512)],512)])])]),t("div",O,[t("button",{type:"button",class:"btn btn-dark",onClick:e[1]||(e[1]=(...u)=>a.submitImgUrl&&a.submitImgUrl(...u))}," 送出 ")])])])],512)],64)}const R=b(C,[["render",Q]]),W={props:["id"],components:{AdminNavBarVue:x,UploadImageModalVue:R},data(){return{myModal:null,tempArticleInfo:{imageUrl:""},imageUrl:"",title:"",content:"",author:"",tag:[],description:"",articleCategory:"",isPublic:!0,create_at:"",url:"https://vue3-course-api.hexschool.io",api_path:"wei123"}},methods:{getUrl(o){this.imageUrl=o},getArticle(o){this.$http.get(`${this.url}/v2/api/${this.api_path}/admin/article/${o}`).then(e=>{this.article=e.data.article,this.title=e.data.article.title,this.create_at=e.data.article.create_at,this.description=e.data.article.description,this.isPublic=e.data.article.isPublic,this.tag=e.data.article.tag,this.author=e.data.article.author,this.content=e.data.article.content,this.imageUrl=e.data.article.image}).catch(e=>{console.log(e.response.data.message)})},adviseArticle(o){this.$http.put(`${this.url}/v2/api/${this.api_path}/admin/article/${o}`,{data:{title:this.title,description:this.description,image:this.imageUrl,tag:this.tag,create_at:this.create_at,author:this.author,isPublic:this.isPublic,content:this.content}}).then(()=>{alert("修改文章成功"),this.$router.push("/adminBlog")}).catch(e=>{console.log(e.response.data.message)})},addTag(o){this.tag===void 0?this.tag=o:this.tag.search(o)===-1&&this.tag.length!==0&&(this.tag=this.tag.concat("、",o))}},mounted(){this.getArticle(this.id),this.getUrl()}},l=o=>(I("data-v-4991951f"),o=o(),A(),o),X={class:"container-fluid"},Y={class:"container py-48",id:"id"},Z=l(()=>t("h2",{class:"fs-40 mb-32 text-center"},"修改文章",-1)),tt={ref:"form"},et={class:"row justify-content-center"},st={class:"col-10"},ot=l(()=>t("label",{class:"fs-24 mb-8",for:"title"},[h("文章標題"),t("span",{class:"text-danger"},"*")],-1)),it={class:"row mb-32 justify-content-center"},at={class:"col-5"},lt=l(()=>t("label",{class:"fs-24",for:"author"},[h(" 文章作者"),t("span",{class:"text-danger"},"*")],-1)),nt={class:"col-5"},ct=l(()=>t("label",{class:"fs-24",for:"articleCategory"},[h(" 文章分類"),t("span",{class:"text-danger"},"*")],-1)),dt={class:"col-10"},rt=l(()=>t("label",{class:"fs-24",for:"description"},[h("文章簡述"),t("span",{class:"text-danger"},"*")],-1)),ht=l(()=>t("label",{class:"fs-24",for:"description"},[h("文章內容"),t("span",{class:"text-danger"},"*")],-1)),mt={class:"row justify-content-center"},pt={class:"col-5 d-flex flex-column justify-content-between align-items-start"},ut=l(()=>t("h3",{class:"fs-24"},"文章發佈狀態",-1)),gt={class:"form-check form-switch"},_t={class:"form-check-label",for:"flexSwitchCheckDefault"},ft={class:"col-5"},bt=l(()=>t("p",{class:"fs-24"},"圖片預覽",-1)),vt=["src"];function yt(o,e,m,p,s,a){const u=f("AdminNavBarVue"),y=f("UploadImageModalVue");return n(),c(v,null,[_(u),t("div",X,[t("div",Y,[Z,t("form",tt,[t("div",et,[t("div",st,[ot,d(t("input",{type:"text",class:"rounded mb-32 form-check-input",style:{width:"100%",height:"40px"},"onUpdate:modelValue":e[0]||(e[0]=i=>s.title=i),name:"title",id:"title"},null,512),[[r,s.title]])])]),t("div",it,[t("div",at,[lt,d(t("input",{type:"text",class:"rounded mb-32 form-check-input",style:{width:"100%",height:"40px"},placeholder:"請填入作者",name:"author",id:"author","onUpdate:modelValue":e[1]||(e[1]=i=>s.author=i)},null,512),[[r,s.author]])]),t("div",nt,[ct,d(t("input",{type:"text",class:"rounded mb-16 form-check-input",style:{width:"100%",height:"40px"},placeholder:"請填入文章分類",name:"articleCategory",id:"articleCategory","onUpdate:modelValue":e[2]||(e[2]=i=>s.tag=i)},null,512),[[r,s.tag]]),t("p",null,[h(" 點擊帶入文章分類： "),t("button",{class:"btn btn-gray me-8",onClick:e[3]||(e[3]=g(i=>a.addTag("最新消息"),["prevent"]))}," 最新消息 "),t("button",{class:"btn btn-gray me-8",onClick:e[4]||(e[4]=g(i=>a.addTag("活動消息"),["prevent"]))}," 活動消息 "),t("button",{class:"btn btn-gray me-8",onClick:e[5]||(e[5]=g(i=>a.addTag("本站獨家"),["prevent"]))}," 本站獨家 ")])]),t("div",dt,[rt,d(t("textarea",{"onUpdate:modelValue":e[6]||(e[6]=i=>s.description=i),class:"rounded mb-24 form-check-input",style:{width:"100%",height:"120px"},placeholder:"請填入 100 字內描述",name:"description",id:"description"},null,512),[[r,s.description]]),ht,d(t("textarea",{type:"text","onUpdate:modelValue":e[7]||(e[7]=i=>s.content=i),class:"rounded mb-24 form-check-input",style:{width:"100%",height:"240px"},placeholder:"請輸入文章內容",name:"content",id:"content"},null,512),[[r,s.content]])])]),t("div",mt,[t("div",pt,[ut,t("div",gt,[d(t("input",{class:"form-check-input",type:"checkbox",id:"flexSwitchCheckDefault","onUpdate:modelValue":e[8]||(e[8]=i=>s.isPublic=i)},null,512),[[w,s.isPublic]]),t("label",_t,$(s.isPublic?"文章公開":"文章不公開"),1)]),_(y,{onEmitImgUrl:a.getUrl},null,8,["onEmitImgUrl"]),t("button",{type:"button",class:"btn btn-gray w-100",onClick:e[9]||(e[9]=i=>a.adviseArticle(m.id))}," 修改文章 ")]),t("div",ft,[bt,t("img",{src:s.imageUrl,alt:"",style:{width:"416px",height:"440px","object-fit":"cover"}},null,8,vt)])])],512)])])],64)}const kt=b(W,[["render",yt],["__scopeId","data-v-4991951f"]]);export{kt as default};
