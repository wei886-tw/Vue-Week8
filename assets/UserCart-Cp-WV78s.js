import{N as k,P,c as v}from"./NavBar-18-K36u7.js";import{_ as M,t as S,u as V,l as d,j as t,i as c,F as f,v as g,y as h,x as m,z as L,g as N,k as u,e as r,A as b,q,s as T}from"./index-Cm9Th8NS.js";const I={props:["finalTotal"],data(){return{api_path:"wei123",url:"https://vue3-course-api.hexschool.io",selectValue:"",cartProducts:[],cartList:{},final_total:"",form:{user:{name:"",email:"",tel:"",address:""},message:"",qty:0},couponModal:"",onSale:!1}},computed:{...S(v,["storeCart"])},components:{NavBar:k,PageFooter:P},methods:{getCartProducts(){this.$http.get(`${this.url}/v2/api/${this.api_path}/cart`).then(s=>{this.cartProducts=s.data.data.carts,this.cartList=s.data.data}).catch(s=>{console.log(s.response.data.message)})},reviseQty(s){this.qty=parseInt(event.target.value),this.$http.put(`${this.url}/v2/api/${this.api_path}/cart/${s}`,{data:{product_id:s,qty:this.qty}}).then(()=>{alert("修改購物車成功"),this.getCartProducts(),this.getCartList()}).catch(o=>{console.log(o.response.data.message)})},delCartItem(s){this.$http.delete(`${this.url}/v2/api/${this.api_path}/cart/${s}`).then(()=>{alert("已經刪除"),this.getCartProducts(),this.getCartList()}).cath(o=>{console.log(o.message)})},enterPayment(){this.$router.push("/userOrder"),window.scrollTo(0,0),this.$emit("emit-cart-list",this.cartList)},backToShop(){this.$router.push("/userProduct")},showCouponModal(){this.couponModal.show()},getCoupon(){this.form.user.name!==""&&this.form.user.email!==""&&this.form.user.phone!==""?this.$http.post(`${this.url}/v2/api/${this.api_path}/coupon`,{data:{code:"15"}}).then(()=>{alert("已套用優惠券，幫您打 8 折！"),this.onSale=!0,this.couponModal.hide()}).catch(s=>{console.log(s.response.data.message)}):alert("請輸入資料已獲取優惠券")},loadingCircle(){let s=this.$loading.show({container:this.fullPage?null:this.$refs.formContainer,canCancel:!0,onCancel:this.onCancel});setTimeout(()=>{s.hide()},500)},isPhone(s){return/^(09)[0-9]{8}$/.test(s)?!0:"需要正確的電話號碼"},...V(v,["getCartList"])},mounted(){this.getCartProducts(),this.loadingCircle(),this.couponModal=new bootstrap.Modal(this.$refs.couponModal),window.scroll(0,0)}},l=s=>(q("data-v-2c6fdb40"),s=s(),T(),s),j={class:"container-fluid px-0"},B={class:"container-fluid px-0",style:{"min-height":"100vh"}},F={class:"container"},U=l(()=>t("h2",{class:"text-center py-60 pb-16 fs-24 fs-lg-32"},"購物車列表",-1)),E={class:"container px-0"},z={key:0,class:"table table-responsive"},A=l(()=>t("thead",null,[t("tr",null,[t("th",{class:"fs-12 fs-md-24",style:{width:"10%"}},"X"),t("th",{class:"fs-12 fs-md-24",style:{width:"30%"}},"品名"),t("th",{class:"fs-12 fs-md-24 rwd"},"圖片"),t("th",{class:"fs-12 fs-md-24",style:{width:"20%"}},"數量"),t("th",{class:"fs-12 fs-md-24",style:{width:"20%"}},"價格")])],-1)),Q={class:"align-middle"},D=["onClick"],O=l(()=>t("i",{class:"bi bi-trash3-fill fs-md-24"},null,-1)),X=[O],G={class:"fs-12 fs-sm-16 fs-md-24 align-middle"},H={class:"align-middle"},J=["src"],K={class:"align-middle"},R=["onChange"],W=["value","selected"],Y={class:"fs-12 fs-sm-16 fs-md-24 align-middle"},Z=l(()=>t("td",null,null,-1)),$=l(()=>t("td",null,null,-1)),tt=l(()=>t("td",null,null,-1)),st=l(()=>t("td",null,null,-1)),et={class:"fs-12 fs-md-16 fs-lg-24 pt-32"},ot={class:"container d-lg-flex flex-column justify-content-between"},lt={class:"container px-0 d-md-flex"},at=l(()=>t("p",null,"原價: ",-1)),nt={key:0,class:"container px-0 d-md-flex"},it=l(()=>t("p",null,"折扣: ",-1)),dt={key:1,class:"container px-0 d-md-flex"},ct=l(()=>t("p",null,"優惠: ",-1)),rt={key:1,class:"text-center fs-24"},ht=l(()=>t("br",null,null,-1)),ut={class:"container px-0"},mt={class:"row"},_t=l(()=>t("div",{class:"col-6"},[t("div",{class:"container d-flex px-0 justify-content-start"})],-1)),pt={class:"col-6"},ft={class:"container px-0 justify-content-end d-flex"},bt={class:"container d-flex px-0 justify-content-end"},vt={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"couponModal"},gt={class:"modal-dialog modal-dialog-centered modal-lg"},yt={class:"modal-content"},Ct=l(()=>t("div",{class:"modal-header"},[t("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"領取優惠券"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),xt={class:"modal-body"},wt=l(()=>t("p",{class:"mb-16"}," 請填寫 Email 及姓名、電話等獲取優惠，我們將不定時發送優惠給您！ ",-1)),kt={class:"mb-12"},Pt=l(()=>t("label",{for:"email",class:"form-label"},null,-1)),Mt={class:"mb-12"},St=l(()=>t("label",{for:"inputName",class:"form-label"},null,-1)),Vt={class:"mb-12"},Lt=l(()=>t("label",{for:"inputTelephone",class:"form-label"},null,-1)),Nt={class:"modal-footer"},qt=l(()=>t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," 取消 ",-1)),Tt={class:"container-fluid px-0"},It={class:"container-fluid"};function jt(s,o,Bt,Ft,a,i){const y=u("NavBar"),_=u("v-field"),p=u("error-message"),C=u("v-form"),x=u("PageFooter"),w=u("router-view");return r(),d(f,null,[t("div",j,[c(y)]),t("div",B,[t("div",F,[U,t("div",E,[a.cartProducts.length!==0?(r(),d("table",z,[A,t("tbody",null,[(r(!0),d(f,null,g(a.cartProducts,e=>(r(),d("tr",{key:e.id},[t("td",Q,[t("button",{class:"btn btn-white",onClick:n=>i.delCartItem(e.id)},X,8,D)]),t("td",G,h(e.product.title),1),t("td",H,[t("img",{src:e.product.imageUrl,alt:"產品圖片",class:"rwd",style:{"object-fit":"cover"}},null,8,J)]),t("td",K,[t("select",{name:"",id:"",onChange:n=>i.reviseQty(e.id),class:"border border-2 border-dark rounded",style:{height:"40px",width:"100%"}},[(r(),d(f,null,g(10,n=>t("option",{value:n,key:n,selected:n===e.qty},h(n),9,W)),64))],40,R)]),t("td",Y,h(Math.floor(parseInt(e.product.price*e.qty))),1)]))),128))]),t("tfoot",null,[Z,$,tt,st,t("td",et,[t("div",ot,[t("div",lt,[at,t("p",null,h(Math.floor(a.cartList.total)),1)]),a.onSale?(r(),d("div",nt,[it,t("p",null,h(Math.floor(a.cartList.total)-Math.floor(a.cartList.final_total)),1)])):m("",!0),a.onSale?(r(),d("div",dt,[ct,t("p",null,h(Math.floor(a.cartList.final_total)),1)])):m("",!0)])])])])):(r(),d("h2",rt,[L(" 您的購物車沒有東西喔，請先加入商品！"),ht,t("button",{class:"btn btn-gray mt-32",onClick:o[0]||(o[0]=(...e)=>i.backToShop&&i.backToShop(...e))}," 返回商品頁面 ")])),t("div",ut,[t("div",mt,[_t,t("div",pt,[t("div",ft,[a.cartProducts.length!==0&&!a.onSale?(r(),d("button",{key:0,type:"button",class:"btn w-50 mb-32 btn-footer",onClick:o[1]||(o[1]=(...e)=>i.showCouponModal&&i.showCouponModal(...e))}," 領取優惠 ")):m("",!0)]),t("div",bt,[a.cartProducts.length!==0?(r(),d("button",{key:0,type:"button",class:"btn w-50 mb-60 btn-footer",onClick:o[2]||(o[2]=(...e)=>i.enterPayment&&i.enterPayment(...e))}," 進入付款頁面 ")):m("",!0)])])])])])])]),t("div",vt,[t("div",gt,[t("div",yt,[Ct,t("div",xt,[wt,c(C,{ref:"form",id:"form"},{default:N(({errors:e})=>[t("div",kt,[Pt,c(_,{id:"email",name:"email",type:"email",class:b(["form-control w-100",{"is-invalid":e.email}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:a.form.user.email,"onUpdate:modelValue":o[3]||(o[3]=n=>a.form.user.email=n)},null,8,["class","modelValue"]),c(p,{name:"email",class:"invalid-feedback"})]),t("div",Mt,[St,c(_,{type:"text",class:b(["form-control w-100",{"is-invalid":e.姓名}]),id:"inputName",name:"姓名",placeholder:"請輸入姓名",rules:"required",modelValue:a.form.user.name,"onUpdate:modelValue":o[4]||(o[4]=n=>a.form.user.name=n)},null,8,["class","modelValue"]),c(p,{name:"姓名",class:"invalid-feedback"})]),t("div",Vt,[Lt,c(_,{type:"tel",class:b(["form-control w-100",{"is-invalid":e.電話}]),id:"inputTelephone",name:"電話",placeholder:"請輸入電話",rules:i.isPhone,modelValue:a.form.user.tel,"onUpdate:modelValue":o[5]||(o[5]=n=>a.form.user.tel=n)},null,8,["class","rules","modelValue"]),c(p,{name:"電話",class:"invalid-feedback"})])]),_:1},512)]),t("div",Nt,[qt,t("button",{type:"button",class:"btn btn-primary",onClick:o[6]||(o[6]=(...e)=>i.getCoupon&&i.getCoupon(...e))}," 領取優惠 ")])])])],512),t("div",Tt,[c(x)]),t("div",It,[c(w)])],64)}const zt=M(I,[["render",jt],["__scopeId","data-v-2c6fdb40"]]);export{zt as default};
//# sourceMappingURL=UserCart-Cp-WV78s.js.map
