import{A as C}from"./AdminNavBar-D55_VW9G.js";import{P as y}from"./PageNation-CqlOXiL6.js";import{_ as M,c as u,b as d,a as e,F as _,g as k,w,r as c,o as h,t as i,i as r,v as p,n as x,l as D}from"./index-DmvZzn9S.js";const V={components:{AdminNavBar:C,PageNation:y},data(){return{api_path:"wei123",url:"https://vue3-course-api.hexschool.io",title:"",is_enabled:!0,percent:"",due_date:"",code:"",myModal:"",coupons:"",couponPagination:"",date:""}},methods:{createCoupon(){this.due_date=parseInt(new Date(this.$refs.date.value).getTime()),this.is_enabled===!0?this.is_enabled=1:this.is_enabled=0,this.$http.post(`${this.url}/v2/api/${this.api_path}/admin/coupon`,{data:{title:this.title,is_enabled:this.is_enabled,percent:this.percent,due_date:this.due_date,code:this.code}}).then(()=>{alert("建立優惠券成功"),this.$refs.form.reset(),this.myModal.hide(),this.getCoupons(1)}).catch(a=>{console.log(a.response.data.message)})},openModal(){this.myModal.show()},closeModal(){this.myModal.hide()},getCoupons(a){this.$http.get(`${this.url}/v2/api/${this.api_path}/admin/coupons?page=${a}`).then(t=>{this.coupons=t.data.coupons,this.couponPagination=t.data.pagination}).catch(t=>{console.log(t.response.data.message)})},adviseCoupon(a){this.$http.put(`${this.url}/v2/api/${this.api_path}/admin/coupon/${a}`,{data:{title:this.title,is_enabled:this.is_enabled,percent:this.percent,due_date:this.due_date}}).then(()=>{this.myModal.show()}).catch(t=>{console.log(t.response.data.message)})},deleteCoupon(a){this.$http.delete(`${this.url}/v2/api/${this.api_path}/admin/coupon/${a}`).then(()=>{alert("已刪除優惠券"),this.getCoupons(1)})}},mounted(){this.myModal=new bootstrap.Modal(this.$refs.couponModal),this.getCoupons(1)}},P={class:"container-fluid px-0"},U={class:"container py-48"},B={class:"container d-flex justify-content-between mb-24"},N=e("h2",{class:"fs-32"},"優惠券管理",-1),A={class:"table mb-16"},F=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"優惠券標題"),e("th",{scope:"col"},"折價"),e("th",{scope:"col"},"到期日"),e("th",{scope:"col"},"是否啟用"),e("th",{scope:"col"},"修改"),e("th",{scope:"col"},"刪除")])],-1),$=["onClick"],j=["onClick"],T={class:"container"},q={class:"modal",tabindex:"-1",ref:"couponModal"},z={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable"},E={class:"modal-content"},I=e("div",{class:"modal-header"},[e("h5",{class:"modal-title"},"建立優惠券"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),L={class:"modal-body"},S={class:"form-group mb-16"},Y=e("label",{for:"title",class:"form-label"},"優惠券名稱",-1),G={class:"form-group mb-16"},H=e("label",{for:"percent",class:"form-label"},"折扣",-1),J={class:"form-group mb-16"},K=e("label",{for:"due_date",class:"form-label"},"到期日",-1),O={class:"form-group mb-16"},Q=e("label",{for:"code",class:"form-label"},"優惠券代碼",-1),R={class:"form-check form-switch mb-16"},W=e("label",{for:"is_enabled",class:"form-check-label"},"是否啟用優惠券",-1),X={class:"modal-footer"},Z={class:"container"};function ee(a,t,te,oe,s,l){const m=c("admin-nav-bar"),b=c("page-nation"),f=c("error-message"),g=c("v-form"),v=c("router-view");return h(),u(_,null,[d(m),e("div",P,[e("div",U,[e("div",B,[N,e("button",{type:"button",class:"btn btn-dark",onClick:t[0]||(t[0]=(...o)=>l.openModal&&l.openModal(...o))}," 建立優惠券 ")]),e("table",A,[F,e("tbody",null,[(h(!0),u(_,null,k(s.coupons,o=>(h(),u("tr",{key:o.id},[e("td",null,i(o.title),1),e("td",null,i(o.percent)+" 折",1),e("td",null,i(new Date(o.due_date).getFullYear())+"/ "+i(new Date(o.due_date).getMonth())+"/ "+i(new Date(o.due_date).getDate()),1),e("td",null,i(o.is_enabled?"是":"否"),1),e("td",null,[e("button",{class:"btn btn-success",onClick:n=>l.adviseCoupon(o.id)}," 修改優惠券 ",8,$)]),e("td",null,[e("button",{class:"btn btn-danger",onClick:n=>l.deleteCoupon(o.id)}," 刪除優惠券 ",8,j)])]))),128))])]),e("div",T,[d(b,{pagination:s.couponPagination,"get-page-products":l.getCoupons,class:"d-flex justify-content-end"},null,8,["pagination","get-page-products"])])])]),e("div",q,[e("div",z,[e("div",E,[I,e("div",L,[d(g,{action:"",ref:"form"},{default:w(({errors:o})=>[e("div",S,[Y,r(e("input",{id:"title","onUpdate:modelValue":t[1]||(t[1]=n=>s.title=n),type:"text",class:x(["form-control",{"is-invalid":o.優惠券名稱}]),placeholder:"請輸入優惠券名稱",rules:"required",name:"優惠券名稱"},null,2),[[p,s.title]]),d(f,{name:"優惠券名稱",class:"invalid-feedback"})]),e("div",G,[H,r(e("input",{id:"percent","onUpdate:modelValue":t[2]||(t[2]=n=>s.percent=n),type:"number",class:"form-control",placeholder:"請輸入折扣"},null,512),[[p,s.percent]])]),e("div",J,[K,r(e("input",{id:"due_date","onUpdate:modelValue":t[3]||(t[3]=n=>s.date=n),type:"date",class:"form-control",placeholder:"請輸入到期日",ref:"date"},null,512),[[p,s.date]])]),e("div",O,[Q,r(e("input",{id:"code","onUpdate:modelValue":t[4]||(t[4]=n=>s.code=n),type:"text",class:"form-control",placeholder:"請輸入優惠券代碼"},null,512),[[p,s.code]])]),e("div",R,[W,r(e("input",{id:"is_enabled","onUpdate:modelValue":t[5]||(t[5]=n=>s.is_enabled=n),type:"checkbox",class:"form-check-input"},null,512),[[D,s.is_enabled]])])]),_:1},512)]),e("div",X,[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal",onClick:t[6]||(t[6]=(...o)=>l.closeModal&&l.closeModal(...o))}," 關閉 "),e("button",{type:"button",class:"btn btn-primary",onClick:t[7]||(t[7]=(...o)=>l.createCoupon&&l.createCoupon(...o))}," 建立優惠券 ")])])])],512),e("div",Z,[d(v)])],64)}const ae=M(V,[["render",ee]]);export{ae as default};
